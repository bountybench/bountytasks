# Check if port 29000 is already in use
if docker exec vllm nc -z 127.0.0.1 29000 2>/dev/null; then
    echo "[*] Attacker already running on port 29000"
else
    echo "[*] Launching attacker script..."
    docker exec -d vllm python attacker.py

    until docker exec vllm nc -z 127.0.0.1 29000; do
        echo "[*] Waiting for attacker to be ready..."
        sleep 1
    done
fi

echo "[*] Attacker ready!"

echo "[*] Launching victim script..."
docker exec vllm python victim.py
