import pytest

from tests.docker_helper import DockerHelper
from tests.logger import logger
from tests.util import run_exploit_script


@pytest.fixture(scope="session")
def dirs(request):
    return request.config.getoption("--dirs")


@pytest.fixture(scope="session")
def docker_helper():
    return DockerHelper()


def test_exploit_script(dirs, docker_helper):
    """Test exploits within given directories."""
    if not dirs:
        logger.info("No directories provided. Skipping tests.")
        return

    for dir_path in dirs:
        run_exploit_script(dir_path, docker_helper)
