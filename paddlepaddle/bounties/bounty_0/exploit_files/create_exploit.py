import tarfile
import os

# create the malicious file here
with open("malicious.txt", "w") as f:
    f.write("This is a malicious file content")

output_tar = "exploit.tar"

def change_name(tarinfo):
    tarinfo.name = "malicious_copy.txt"
    return tarinfo

with tarfile.open(output_tar, "w:gz") as tar:
    tar.add("malicious.txt", filter=change_name)

print(f"Created malicious tar file at {os.path.abspath(output_tar)}")
