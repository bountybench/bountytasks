(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1058],{94932:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(57437),a=n(2265),l=n(93671);n(8511),n(74590);var i=(0,n(58064).$)("6a0cf8bd446ee80b120fd7637225513b6a9ea6aa"),s=n(30998),o=n(23580),c=n(87138);let u=(e,t,n)=>(0,r.jsxs)("div",{className:" py-2 text-sm",children:[(0,r.jsxs)("p",{children:[" ","You have another open report in ",t,"/",n," of the same type (CWE)."]}),"Please bundle this vulnerability to your"," ",(0,r.jsx)(c.default,{className:" text-blue-500 hover:underline",href:"/bounties/edit/".concat(e),children:"existing report"})," ","as an occurence instead of opening a new report. You will be compensated for each occurence."]});var d=e=>{let{repoName:t,repoOwner:n,onOptionChange:c,initialCwe:d}=e,[p,h]=(0,a.useState)([]),[m,x]=(0,a.useState)([]),[f,b]=(0,a.useState)(d||null);(0,a.useEffect)(()=>{(async()=>{try{let e=await (0,s.getSession)(),r=null==e?void 0:e.user.username,a=(await i(null!=r?r:"")).filter(e=>{var r;return e&&e.vulnerability&&"disclosure_submission"===e.type&&"pending"===e.vulnerability.status&&(null===(r=e.vulnerability.repository)||void 0===r?void 0:r.name)===t&&e.vulnerability.repository.owner===n}).map(e=>{var t,n,r;return{vulnerability_id:null==e?void 0:null===(t=e.vulnerability)||void 0===t?void 0:t.id,cwe_id:null==e?void 0:null===(r=e.vulnerability)||void 0===r?void 0:null===(n=r.cwe)||void 0===n?void 0:n.id}});x(a)}catch(e){console.error(e)}})()},[t,n]),(0,a.useEffect)(()=>{(async()=>{h((await (await fetch("/api/cwe-list")).json()).map(e=>({id:e.id,value:e.description||e.title,label:e.description||e.title})))})()},[]);let v=e=>{let r=m.find(t=>t.cwe_id===(null==e?void 0:e.id));r?(0,o.Am)(u(r.vulnerability_id,n,t),{type:"warning"}):(b(e),c(e))};return(0,r.jsx)(l.ZP,{id:"cwe-select",value:f,onChange:e=>v(e),options:p,classNamePrefix:"react-select",className:"text-sm",theme:e=>({...e,borderRadius:0,colors:{...e.colors,primary25:"#2684FF"}}),placeholder:"Please select a vulnerability type..."})}},11058:function(e,t,n){"use strict";n.d(t,{Z:function(){return U}});var r=n(57437),a=n(2265),l=n(50551),i=n.n(l),s=n(30998),o=n(65354),c=n(6920),u=n(45079),d=n(94932);let p=e=>{try{let[,t]=new URL(e).pathname.split("/");return t.toLowerCase()}catch(e){return""}},h=e=>{try{let[,,t]=new URL(e).pathname.split("/");return t.toLowerCase()}catch(e){return""}},m=e=>{let t=e.lastIndexOf("#"),n=e.substring(t+1).replaceAll("L",""),r=[];if(n.includes("-")){let e=n.split("-").map(Number);isNaN(e[0])||isNaN(e[1])||r.push(e[0],e[1])}else{let e=Number(n);isNaN(e)||r.push(e,e)}return r.length>0?r:null},x=e=>{let t=new URL(e),n=t.hash.indexOf("#");return t.pathname+(-1===n?"":t.hash.substring(0,n))},f=e=>{let t=e.match(/\/blob\/([^\/]+)\//);return t?t[1]:null},b=(e,t)=>f(e)!==f(t),v=(e,t)=>{if(x(e)!==x(t))return!1;let n=m(e),r=m(t);return!!n&&!!r&&n[0]<=r[1]&&r[0]<=n[1]},y=(e,t)=>{if(x(e)!==x(t))return!1;let n=m(e),r=m(t);return!!n&&!!r&&(2>=Math.abs(n[0]-r[1])||2>=Math.abs(r[0]-n[1]))},g=(e,t,n,r)=>{let a,l;let i=e[t];if(!/https?:\/\/(www\.)?github\.com\/([-a-zA-Z0-9()@:%_\+.~#?&\/\/=]+)\/[-a-zA-Z0-9()@:%_\+.~#?&\/\/=]+\/[-a-zA-Z0-9()@:%_\+.~#?&\/\/=]+#L([0-9]+)(-?L(([0-9]+)))?$/gm.test(i))return"The format of this permalink is invalid";try{let e=new URL(i);[,a,l]=e.pathname.split("/")}catch(e){return"The format of this permalink is invalid"}if(!((null==a?void 0:a.toLowerCase())===n.toLowerCase()&&(null==l?void 0:l.toLowerCase())===r.toLowerCase()))return"The repository in this permalink does not match the one targeted";if(t===e.length-1){for(let n=0;n<e.length;n++)if(n!==t){let t=e[n];if(v(i,t))return"This permalink overlaps with another permalink";if(y(i,t))return"This permalink is too close to another permalink";if(b(i,t))return"All permalinks must be on the same branch"}}return null};n(74590);var w=n(58064),N=(0,w.$)("c7bd5753c501703315d66c982679fca24ec8cffe"),j=(0,w.$)("12ae119ebb98ac260982038591aeea878f6646bd"),k=n(16463),C=n(23580),S=e=>{let{input:t,formCompleted:n,edit:l,bountyId:i}=e,s=(0,k.useRouter)(),[o,c]=(0,a.useState)(!1),u=async()=>{try{c(!0);let e=await j(t);(0,C.Am)("Disclosure received!",{type:"success"}),s.push("/bounties/".concat(e))}catch(e){(0,C.Am)("Error: ".concat(e.message),{type:"error"}),console.error(e)}finally{c(!1)}},d=async()=>{try{c(!0);let e=await N(null!=i?i:"",t);(0,C.Am)("Changes saved!",{type:"success"}),s.push("/bounties/".concat(e))}catch(e){(0,C.Am)("Error: ".concat(e.message),{type:"error"}),console.error(e)}finally{c(!1)}};return(0,r.jsx)("button",{className:"inline-block self-center rounded-sm bg-brick px-6 py-2 font-industry focus:outline-none ".concat(o||!n?"cursor-not-allowed opacity-50":"hover:bg-tang"),disabled:o||!n,onClick:l?d:u,children:o?"Submitting...":l?"Save Changes":"Submit Report"})},_=n(19212),L=n.n(_),P=n(54107),A=n(25968);n(83417);var R=n(76113),I=n(52879),E=n(18441),H=n(20357);let O=i()(()=>Promise.all([n.e(9461),n.e(6799),n.e(9343),n.e(1289),n.e(8547)]).then(n.bind(n,16899)),{loadableGenerated:{webpack:()=>[16899]}});var U=e=>{let{bountyId:t,mode:n,readmeProp:l,cvssProp:i,cweProp:m,targetUrlProp:x,permalinksProp:f,referencesProp:b,disclosureAmountProp:v,titleProp:y,impactProp:w,packageProp:N,versionProp:j}=e,{data:C}=(0,s.useSession)(),_=(0,k.usePathname)(),U=new P._({highlight:function(e,t){if(t&&A.Z.getLanguage(t))try{return A.Z.highlight(t,e).value}catch(e){}try{return A.Z.highlightAuto(e).value}catch(e){}return""}}),M=Object.values(E.I2),V={AV:{label:"Attack Vector",options:{[I.uf.N]:"Network",[I.uf.A]:"Adjacent",[I.uf.L]:"Local",[I.uf.P]:"Physical"}},AC:{label:"Attack Complexity",options:{[I.av.L]:"Low",[I.av.H]:"High"}},PR:{label:"Privileges Required",options:{[I.P4.N]:"None",[I.P4.L]:"Low",[I.P4.H]:"High"}},UI:{label:"User Interaction",options:{[I.zg.N]:"None",[I.zg.R]:"Required"}},S:{label:"Scope",options:{[I.PE.U]:"Unchanged",[I.PE.C]:"Changed"}},C:{label:"Confidentiality",options:{[I.vO.N]:"None",[I.vO.L]:"Low",[I.vO.H]:"High"}},I:{label:"Integrity",options:{[I.SW.N]:"None",[I.SW.L]:"Low",[I.SW.H]:"High"}},A:{label:"Availability",options:{[I.P5.N]:"None",[I.P5.L]:"Low",[I.P5.H]:"High"}}},[W,T]=(0,a.useState)(!1),[D,F]=(0,a.useState)(!1),[Z,q]=(0,a.useState)(0),[z]=(0,a.useState)(!0),[G,Y]=(0,a.useState)(x),[$,B]=(0,a.useState)(null!=N?N:""),[J,K]=(0,a.useState)(null!=j?j:""),[Q,X]=(0,a.useState)(null!=y?y:""),[ee,et]=(0,a.useState)(null!=l?l:"# Description\nPlease enter a description of the vulnerability.\n\n # Proof of Concept\n```\n// PoC.js\nvar payload = ...\n```"),[en,er]=(0,a.useState)(null!=w?w:""),[ea,el]=(0,a.useState)(!!l),[ei,es]=(0,a.useState)(null!=f?f:[{url:"",description:""}]),[eo,ec]=(0,a.useState)(!!f),[eu,ed]=(0,a.useState)(x?h(x):""),[ep,eh]=(0,a.useState)(x?p(x):""),[em,ex]=(0,a.useState)(null!=v?v:0),[ef,eb]=(0,a.useState)(0),[ev]=(0,a.useState)(!1),[ey,eg]=(0,a.useState)(null!=b?b:[{url:"",name:""}]),[ew,eN]=(0,a.useState)(null!=m?m:null),[ej,ek]=(0,a.useState)(i?(0,o.vr)(i):{AV:null,AC:null,PR:null,UI:null,S:null,C:null,I:null,A:null}),[eC,eS]=(0,a.useState)(null),[e_,eL]=(0,a.useState)({attack_vector:void 0,attack_complexity:void 0,privileges_required:void 0,user_interaction:void 0,scope:void 0,confidentiality:void 0,integrity:void 0,availability:void 0});(0,a.useEffect)(()=>{G&&(eh(p(G)),ed(h(G)))},[G]),(0,a.useEffect)(()=>{if(F(Object.values(ej).every(e=>e)),D){let e={attack_vector:ej.AV,attack_complexity:ej.AC,privileges_required:ej.PR,user_interaction:ej.UI,scope:ej.S,confidentiality:ej.C,integrity:ej.I,availability:ej.A};eL(e);let{score:t}=(0,o.nL)(e);eS(null!=t?t:null)}},[ej,D]),(0,a.useEffect)(()=>{ei&&ec(ei.every((e,t)=>null===g(ei.map(e=>e.url),t,ep,eu)))},[ei,ep,eu]),(0,a.useEffect)(()=>{eb((ei.length-1)*Z)},[ei,Z]),(0,a.useEffect)(()=>{em&&q(.2*em)},[em]);let eP=(e,t)=>{ek(n=>({...n,[e]:t}))},eA=()=>{es([...ei,{url:"",description:""}])},eR=e=>{es(ei.filter((t,n)=>n!==e))},eI=e=>{eg(ey.filter((t,n)=>n!==e))},eE=e=>{let t=e.lastIndexOf("/");return e.substring(t+1)},eH={title:Q,read_me:ee,summary:ew?null==ew?void 0:ew.label:"",cwe_id:ew?null==ew?void 0:ew.id:"",cvss:{attack_vector:e_.attack_vector||I.uf.N,attack_complexity:e_.attack_complexity||I.av.L,privileges_required:e_.privileges_required||I.P4.N,user_interaction:e_.user_interaction||I.zg.N,scope:e_.scope||I.PE.U,confidentiality:e_.confidentiality||I.vO.N,integrity:e_.integrity||I.SW.N,availability:e_.availability||I.P5.N},repository_name:eu,repository_owner:ep,references:ey,new_permalinks:ei,package_registry:$,affected_version:J,impact:en,project:"other/project"===$},eO=!_.startsWith("/bounties/edit/")&&(!W||!C||!1===z||ev),eU=!$||!C||!1===z,eM=!J||!C||!1===z,eV=!D,eW=!(Q&&ea&&en),eT=!eo||!ea;return(0,r.jsxs)("div",{id:"form-container",className:"!relative",children:[!_.includes("edit")&&(0,r.jsxs)("h2",{className:"mb-2 font-industry text-2xl",children:["Repository ",(0,r.jsx)("span",{className:"text-rose-600",children:"*"}),W?(0,r.jsx)(c.G,{icon:u.LEp,className:"ml-2 h-4 w-4 text-super-bright-green"}):null]}),(0,r.jsx)("div",{className:"sticky z-40 mb-12 ".concat(_.includes("edit")?"top-3":"-top-11"),children:(0,r.jsx)(O,{targetUrlProp:G,...D?{cvss:e_}:{},cvssScore:eC||void 0,permalinksTotalAmount:ef,validSearch:e=>T(null!=e&&e),onTargetUrlChange:e=>Y(e||""),onBountyRewardChange:e=>ex(e||0)})}),(0,r.jsxs)("section",{className:"mb-12  sm:w-full md:w-full lg:w-full ".concat(eO?"pointer-events-none cursor-not-allowed opacity-30":""),children:[(0,r.jsxs)("h2",{className:"font-industry text-2xl",children:["Package Manager ",(0,r.jsx)("span",{className:"text-rose-600",children:"*"}),$?(0,r.jsx)(c.G,{icon:u.LEp,className:"ml-2 h-4 w-4 text-super-bright-green"}):null]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("h3",{className:"mb-2 font-work-sans text-sm text-white text-opacity-60",children:"Please choose a corresponding package manager for the repository."}),(0,r.jsxs)("select",{id:"package-select",value:$,onChange:e=>B(e.target.value),className:"h-10 rounded border-none bg-space text-white","aria-label":"Select a package manager",children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"Select a package manager..."}),M.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]})]}),(0,r.jsxs)("section",{id:"version",className:"mb-12 sm:w-full md:w-full lg:w-full ".concat(eU?"pointer-events-none cursor-not-allowed opacity-30":""),children:[(0,r.jsxs)("h2",{className:"font-industry text-2xl",children:["Version Affected ",(0,r.jsx)("span",{className:"text-rose-600",children:"*"}),J?(0,r.jsx)(c.G,{icon:u.LEp,className:"ml-2 h-4 w-4 text-super-bright-green"}):null]}),(0,r.jsx)("div",{className:"flex flex-row",children:(0,r.jsx)("h3",{className:"mb-2 font-work-sans text-sm text-white text-opacity-60",children:"Please enter the version affected by the vulnerability."})}),(0,r.jsx)("input",{id:"version-select",value:J,onChange:e=>K(e.target.value),className:"h-10 w-full rounded border-none bg-space text-white placeholder-white placeholder-opacity-50",placeholder:"Please enter the version(s) affected (i.e. 0.1.1)...",type:"text"})]}),(0,r.jsxs)("section",{className:"mb-12 ".concat(eM?"pointer-events-none cursor-not-allowed opacity-30":""),children:[(0,r.jsxs)("h2",{className:"font-industry text-2xl",children:["Vulnerability Type",(0,r.jsx)("span",{className:"text-rose-600",children:"*"}),ew?(0,r.jsx)(c.G,{icon:u.LEp,className:"ml-2 h-4 w-4 text-super-bright-green"}):null]}),(0,r.jsx)("div",{className:"flex flex-row",children:(0,r.jsx)("h3",{className:"mb-2 font-work-sans text-sm text-white text-opacity-60",children:"Please classify your report accurately. Some vulnerability types are not eligible for automatic CVE assignment."})}),(0,r.jsx)(d.Z,{repoName:eu,repoOwner:ep,onOptionChange:eN,initialCwe:m||null})]}),(0,r.jsxs)("section",{className:"mb-12 ".concat(ew&&C&&!1!==z?"":"pointer-events-none cursor-not-allowed opacity-30"),children:[(0,r.jsxs)("h2",{className:"font-industry text-2xl",children:["CVSS ",(0,r.jsx)("span",{className:"text-rose-600",children:"*"}),D?(0,r.jsx)(c.G,{icon:u.LEp,className:"ml-2 h-4 w-4 text-super-bright-green"}):null]}),(0,r.jsxs)("h3",{className:"font-work-sans text-sm text-white text-opacity-60",children:["Please rate the severity of your report fairly; it affects your bounty. For more information on CVSS,"," ",(0,r.jsx)("a",{className:"underline hover:text-blue-400",href:"https://www.first.org/cvss/",target:"_blank",rel:"noopener noreferrer",children:"click here"}),"."]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-x-10 gap-y-10 pr-3 pt-6",children:Object.entries(V).map(e=>{let[t,{label:n,options:a}]=e;return(0,r.jsxs)("div",{className:"flex flex-col pb-5 text-left",children:[(0,r.jsx)("div",{className:"pb-2",children:(0,r.jsx)("h1",{className:"text-xs text-white text-opacity-60",children:n})}),(0,r.jsx)("div",{className:"mx-auto inline-flex rounded-md border border-white border-opacity-20 sm:grid-cols-4",children:Object.entries(a).map(e=>{let[n,a]=e;return(0,r.jsx)("button",{disabled:!C,className:"px-4 py-2 ".concat(ej[t]===n?"bg-brick ":"bg-white bg-opacity-10 hover:bg-opacity-20"," rounded-md text-sm font-medium text-white focus:outline-none"),onClick:()=>eP(t,n),children:a},n)})})]},t)})}),null!==eC&&(0,r.jsx)("div",{className:"float-right mt-6 flex",children:(0,r.jsxs)("h1",{className:"text-3xl font-bold text-white",children:["CVSS Score: ",eC]})})]}),(0,r.jsxs)("section",{id:"write-up",className:"mb-12 ".concat(eV?"pointer-events-none cursor-not-allowed opacity-30":""),children:[(0,r.jsxs)("h2",{className:"font-industry text-2xl",children:["Write-up ",(0,r.jsx)("span",{className:"text-rose-600",children:"*"}),ea&&ee&&Q&&en?(0,r.jsx)(c.G,{icon:u.LEp,className:"ml-2 h-4 w-4 text-super-bright-green"}):null]}),(0,r.jsxs)("h2",{className:"mb-6 font-work-sans text-sm text-white text-opacity-60",children:["Use the"," ",(0,r.jsx)("a",{href:"https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet",className:"underline hover:text-blue-400",target:"_blank",rel:"noopener noreferrer",children:"markdown"})," ","template to explain further details about the vulnerability."]}),(0,r.jsxs)("label",{htmlFor:"write-up-title",className:"mb-1 block font-industry text-xs text-white text-opacity-60",children:["Title ",(0,r.jsx)("span",{className:"text-rose-600",children:"*"})]}),(0,r.jsx)("input",{id:"write-up-title",value:Q,onChange:e=>X(e.target.value),placeholder:"Please enter a title that summarises the vulnerability...",className:"mb-3 w-full rounded border-none bg-space text-white placeholder-white placeholder-opacity-50 focus:border-transparent focus:outline-none",type:"text"}),(0,r.jsxs)("label",{htmlFor:"readmeProp-input",className:"mb-1 block text-xs font-medium text-white text-opacity-60",children:["Description ",(0,r.jsx)("span",{className:"text-rose-600",children:"*"})]}),(0,r.jsx)("textarea",{id:"readmeProp-input",value:ee,onChange:e=>{et(e.target.value),el(!0)},className:"mb-2 h-72 w-full rounded border-none bg-space text-white",disabled:!C}),(0,r.jsxs)("label",{htmlFor:"impactProp-input",className:"mb-1 block text-xs font-medium text-white text-opacity-60",children:["Impact ",(0,r.jsx)("span",{className:"text-rose-600",children:"*"})]}),(0,r.jsx)("textarea",{id:"impactProp-input",value:en,onChange:e=>er(e.target.value),className:"h-72 w-full rounded border-none bg-space text-white placeholder-white placeholder-opacity-50",placeholder:"This vulnerability is capable of...",disabled:!C})]}),(0,r.jsxs)("section",{id:"permalink-input",className:"mb-12 ".concat(eW?"pointer-events-none cursor-not-allowed opacity-30":""),children:[(0,r.jsxs)("h2",{className:"font-industry text-2xl",children:["Occurrences ",(0,r.jsx)("span",{className:"text-rose-600",children:"*"}),eo?(0,r.jsx)(c.G,{icon:u.LEp,className:"ml-2 h-4 w-4 text-super-bright-green"}):null]}),(0,r.jsxs)("h2",{className:"mb-6 font-work-sans text-sm text-white text-opacity-60",children:["Please provide every occurrence of this vulnerability as it appears in the repo using"," ",(0,r.jsx)("a",{className:"underline hover:text-blue-400",href:"https://docs.github.com/en/github/managing-your-work-on-github/creating-a-permanent-link-to-a-code-snippet",target:"_blank",rel:"noopener noreferrer",children:"permalinks"}),".",(0,r.jsx)("br",{}),"You will receive a 20% bonus of your base bounty for every occurrence (lines of code) that gets modified in the patch. If however, an occurrence you provide remains unchanged in the patch, you will not receive the bonus for that particular occurrence."]}),ei.map((e,t)=>(0,r.jsxs)("div",{children:[t>0&&(0,r.jsx)("span",{className:"float-right mb-1 cursor-pointer rounded bg-red-600 bg-opacity-20 px-2 py-0.5 text-xs font-medium text-red-600 hover:bg-opacity-40",onClick:()=>eR(t),children:"delete"}),(0,r.jsxs)("div",{className:"".concat(t?"mt-10":""),children:[(0,r.jsxs)("label",{htmlFor:"permalink-url-".concat(t),className:"mb-1 block text-xs font-medium text-white text-opacity-60",children:["Permalink ",(0,r.jsx)("span",{className:"text-rose-600",children:"*"}),t>0&&(0,r.jsxs)("span",{className:"ml-2 text-sm font-medium text-super-bright-green",children:["$",Z]})]}),(0,r.jsx)("input",{id:"permalink-url-".concat(t),value:e.url,onChange:e=>{let n=[...ei];n[t].url=e.target.value,es(n)},className:"w-full rounded border-none border-opacity-20 bg-space text-sm text-white placeholder-white placeholder-opacity-50 focus:border-transparent focus:outline-none",type:"text",placeholder:"https://github.com/owner/name/blob/branch/file.extention#L1-L19"}),g(ei.map(e=>e.url),t,ep,eu)&&e.url&&(0,r.jsx)("div",{className:"mt-2 text-xs font-medium text-red-500",children:g(ei.map(e=>e.url),t,ep,eu)}),(0,r.jsx)("label",{htmlFor:"description-".concat(t),className:"mb-1 mt-4 block text-xs font-medium text-white text-opacity-60",children:"Description"}),(0,r.jsx)("textarea",{id:"description-".concat(t),value:e.description,onChange:e=>{let n=[...ei];n[t].description=e.target.value,es(n)},className:"h-28 w-full rounded border-none bg-space text-sm text-white placeholder-white placeholder-opacity-50",placeholder:"Supports markdown. This field can be left empty.\n```\n##POC\n```"})]})]},t)),(0,r.jsxs)("button",{disabled:!eo,className:"mt-4 rounded-sm bg-brick px-4 py-1 font-industry text-sm font-medium outline-none transition hover:bg-tang focus:outline-none ".concat(eo?"":"cursor-not-allowed opacity-50"),onClick:()=>{eA()},children:[(0,r.jsx)("i",{className:"fas fa-plus mr-1 pb-0.5 font-bold"}),"NEW OCCURRENCE"]})]}),(0,r.jsxs)("section",{id:"references",className:"mb-12 ".concat(eT?"pointer-events-none cursor-not-allowed opacity-30":""),children:[(0,r.jsx)("h2",{className:"font-industry text-2xl font-bold",children:"References "}),(0,r.jsx)("h2",{className:"mb-6 font-work-sans text-sm text-white text-opacity-60",children:"Please add any supporting references below and optionally give each a name."}),ey.map((e,t)=>(0,r.jsxs)("div",{className:"mb-8",children:[t>0&&(0,r.jsx)("span",{className:"float-right mb-1 cursor-pointer rounded bg-red-600 bg-opacity-20 px-2 py-0.5 text-xs font-medium text-red-600 hover:bg-opacity-40",onClick:()=>eI(t),children:"delete"}),(0,r.jsx)("label",{className:"mb-1 block text-xs font-medium text-white text-opacity-60",children:"Reference URL"}),(0,r.jsx)("input",{value:e.url,onChange:e=>{let n=[...ey];n[t].url=e.target.value,eg(n)},className:"w-full rounded border-none border-opacity-20 bg-space text-sm text-white placeholder-white placeholder-opacity-50",type:"text",placeholder:"https://your-reference.com/...",disabled:!C}),e.url&&!e.url.startsWith("https://")&&""!==e.url&&(0,r.jsx)("p",{className:"mt-2 text-xs font-medium text-yellow-400",children:"Please enter a valid URL including 'https://'"}),(0,r.jsx)("label",{className:"mb-1 mt-3 block text-xs font-medium text-white text-opacity-60",children:"Name"}),(0,r.jsx)("input",{value:e.name,onChange:e=>{let n=[...ey];n[t].name=e.target.value,eg(n)},className:"w-full rounded border-none bg-space text-sm text-white placeholder-white placeholder-opacity-50",type:"text",disabled:!C})]},t)),(0,r.jsx)("button",{disabled:!C,className:"rounded-sm bg-brick px-4 py-1 font-industry text-sm font-medium outline-none transition hover:bg-tang focus:outline-none ".concat(C?"":"cursor-not-allowed opacity-50"),onClick:()=>{eg([...ey,{url:"",name:""}])},children:"NEW REFERENCE"})]}),eo&&(0,r.jsxs)("section",{id:"preview",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Preview"}),(0,r.jsx)("h2",{className:"mb-6 text-sm text-white text-opacity-60",children:"Happy with everything?"}),(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)("div",{children:"Loading..."}),children:(0,r.jsxs)("div",{className:"rounded bg-space p-5 font-sans",children:[(0,r.jsxs)("h1",{id:"title",className:"text-2xl font-medium",children:["".concat(Q," in "),(0,r.jsx)("a",{className:"break-words hover:text-blue-400 hover:underline",href:"https://www.github.com/".concat(ep,"/").concat(eu),target:"_blank",rel:"noopener noreferrer",children:"".concat(ep,"/").concat(eu)})]}),(0,r.jsxs)("div",{className:"inline-block text-xs font-medium opacity-60",children:["Reported on ",L()(new Date).format("MMM Do YYYY")]}),(0,r.jsx)("hr",{className:"mb-3 mt-4 w-full border-b border-dotted border-white border-opacity-40"}),(0,r.jsxs)("div",{id:"read-me-container",children:[(0,r.jsx)("div",{className:"markdown-body",dangerouslySetInnerHTML:{__html:U.render(en?"".concat(null!=ee?ee:"","\n\n# Impact\n\n").concat(en):null!=ee?ee:"")}}),(0,r.jsx)("h2",{id:"occurences-title",className:"mb-3 mt-6 text-2xl font-medium",children:"Occurences"}),ei.map((e,t)=>(0,r.jsx)("div",{className:"permalinkMD ".concat(e.description?"mb-8":"mb-3 inline-block"),children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("a",{className:"permalink group mr-2 inline-flex cursor-pointer bg-space py-1 pl-2 pr-3 ".concat(e.description?"rounded-t border-b-0":"rounded "),href:e.url.startsWith("http://")||e.url.startsWith("https://")?e.url:"http://".concat(e.url),children:[(0,r.jsx)(R.Z,{permalink:e.url}),(0,r.jsx)("p",{className:"self-center break-all text-white text-opacity-60 group-hover:text-blue-400 group-hover:underline",children:eE(e.url)})]}),e.description&&(0,r.jsx)("div",{className:"markdown-body permalinkMD rounded rounded-tl-none border-2 border-opacity-10 p-4",dangerouslySetInnerHTML:{__html:U.render(e.description)}})]})},t)),ey[0]&&""!==ey[0].url&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{id:"reference-title",className:"mb-3 mt-6 text-2xl font-medium",children:"References"}),(0,r.jsx)("ul",{className:"ml-5 list-disc",children:ey.map((e,t)=>(0,r.jsx)("li",{children:(0,r.jsx)("a",{className:"break-all text-blue-400 hover:underline",href:e.url.startsWith("http://")||e.url.startsWith("https://")?e.url:"http://".concat(e.url),children:""===e.name?e.url:e.name})},t))})]})]})]})})]}),(0,r.jsxs)("div",{className:"mb-6 mt-16 text-right",children:[(0,r.jsx)(S,{input:eH,formCompleted:!eT,edit:"edit"===n,bountyId:t}),"edit"!==n&&(0,r.jsxs)("p",{className:"mt-6 font-work-sans text-sm text-white text-opacity-60",children:["Please note that after report submission you have ".concat(H.env.RESEARCHER_EDIT_WINDOW||20," minutes to make edits,"),(0,r.jsx)("br",{}),"afterwards you will be blocked from making any further changes."]})]})]})}},76113:function(e,t,n){"use strict";var r=n(57437),a=n(2265),l=n(66648);t.Z=function(e){let{permalink:t}=e,n=a.useMemo(()=>{let e=t.lastIndexOf("/"),n=t.substring(e+1);return n.substr(n.lastIndexOf(".")+1).split("#")[0]},[t]);function i(e){switch(e){case"php":return"php_elephant";case"js":return"javascript";case"java":return"java";case"pm":return"perl";case"py":return"python";case"vue":return"vue";case"c":return"c";case"cpp":case"h":return"cpp";case"cs":return"csharp";case"ts":return"typescript";case"e":return"elixir";default:return"file"}}return(0,r.jsx)(l.default,{src:"/extensions/".concat(i(n),".svg"),alt:"".concat(i(n)),width:20,height:15,className:"mr-1.5 inline h-5 self-center"})}},52879:function(e,t,n){"use strict";var r,a,l,i,s,o,c,u,d,p,h,m,x,f,b,v,y,g;n.d(t,{Jb:function(){return r},P4:function(){return c},P5:function(){return i},PE:function(){return u},SW:function(){return o},av:function(){return a},uf:function(){return l},vO:function(){return s},zg:function(){return d}}),(p=r||(r={})).Duplicate="duplicate",p.Informative="informative",p.Invalid="invalid",p.NotApplicable="not_applicable",p.Pending="pending",p.SelfClosed="self_closed",p.Spam="spam",p.Valid="valid",(h=a||(a={})).H="H",h.L="L",(m=l||(l={})).A="A",m.L="L",m.N="N",m.P="P",(x=i||(i={})).H="H",x.L="L",x.N="N",(f=s||(s={})).H="H",f.L="L",f.N="N",(b=o||(o={})).H="H",b.L="L",b.N="N",(v=c||(c={})).H="H",v.L="L",v.N="N",(y=u||(u={})).C="C",y.U="U",(g=d||(d={})).N="N",g.R="R"},65354:function(e,t,n){"use strict";n.d(t,{M3:function(){return s},SH:function(){return d},WJ:function(){return p},_3:function(){return l},d4:function(){return o},m:function(){return a},nL:function(){return u},t7:function(){return i},vr:function(){return c}});var r=n(43437);let a=e=>{var t,n;let r=e.title||(null===(t=e.cwe)||void 0===t?void 0:t.description)||(null===(n=e.cwe)||void 0===n?void 0:n.title);return(null==r?void 0:r.length)&&r.length>80?"".concat(r.substring(0,80).trim(),"..."):r},l=e=>{var t;return null==e?void 0:null===(t=e.status)||void 0===t?void 0:t.replace("_"," ")},i=(e,t)=>{let n;if(t)return{severity:t};if(!e)return{severity:"unknown"};let{attack_complexity:a,attack_vector:l,availability:i,confidentiality:s,integrity:o,privileges_required:c,scope:u,user_interaction:d}=e,p=(0,r.vo)("CVSS:3.0/AV:".concat(l,"/AC:").concat(a,"/PR:").concat(c,"/UI:").concat(d,"/S:").concat(u,"/C:").concat(s,"/I:").concat(o,"/A:").concat(i));switch(!0){case p>=9:n="Critical";break;case p>=7:n="High";break;case p>=4:n="Medium";break;case p>=.1:n="Low";break;default:n="None"}return{severity:n,score:p}},s=(e,t)=>{var n;return e?(null===(n=({attackVector:{N:"Network",A:"Adjacent",L:"Local",P:"Physical"},attackComplexity:{L:"Low",H:"High"},privilegesRequired:{N:"None",L:"Low",H:"High"},userInteraction:{N:"None",R:"Required"},scope:{U:"Unchanged",C:"Changed"},confidentiality:{N:"None",L:"Low",H:"High"},integrity:{N:"None",L:"Low",H:"High"},availability:{N:"None",L:"Low",H:"High"}})[t])||void 0===n?void 0:n[e])||e:"Unknown"},o=e=>{switch(e.status){case"valid":if(e.patch_commit_sha)return"Fixed";return"Awaiting fix";case"pending":return"Awaiting review";case"invalid":return"Invalid";case"not_applicable":return"N/A";case"spam":return"Spam";case"duplicate":return"Duplicate";case"informative":return"Informative";case"self_closed":return"Closed";default:return"Unknown"}},c=e=>({AV:e.attack_vector,AC:e.attack_complexity,PR:e.privileges_required,UI:e.user_interaction,S:e.scope,C:e.confidentiality,I:e.integrity,A:e.availability}),u=e=>{let t,n;let a={severity:"None",score:0,color:"border-blue-500",cvssString:""};if(!e)return a;let{attack_complexity:l,attack_vector:i,availability:s,confidentiality:o,integrity:c,privileges_required:u,scope:d,user_interaction:p}=e;if(!l||!i||!s||!o||!c||!u||!d||!p)return a;let h=(0,r.vo)("CVSS:3.0/AV:".concat(i,"/AC:").concat(l,"/PR:").concat(u,"/UI:").concat(p,"/S:").concat(d,"/C:").concat(o,"/I:").concat(c,"/A:").concat(s)),m="CVSS:3.1/AV:".concat(i,"/AC:").concat(l,"/PR:").concat(u,"/UI:").concat(p,"/S:").concat(d,"/C:").concat(o,"/I:").concat(c,"/A:").concat(s);switch(!0){case h>=9:t="Critical",n="border-purple-600";break;case h>=7:t="High",n="border-red-600";break;case h>=4:t="Medium",n="border-orange-activity";break;case h>=.1:t="Low",n="border-yellow-activity";break;default:t="None",n="border-blue-500"}return{severity:t,score:h,color:n,cvssString:m}},d=e=>{let t,n;if(!e)return{severity:"Loading...",score:0};if(e.maintainer_severity)return{severity:e.maintainer_severity};if(!e.cvss)return{severity:"unknown"};let{attack_complexity:a,attack_vector:l,availability:i,confidentiality:s,integrity:o,privileges_required:c,scope:u,user_interaction:d}=e.cvss,p=(0,r.vo)("CVSS:3.0/AV:".concat(l,"/AC:").concat(a,"/PR:").concat(c,"/UI:").concat(d,"/S:").concat(u,"/C:").concat(s,"/I:").concat(o,"/A:").concat(i)),h="CVSS:3.1/AV:".concat(l,"/AC:").concat(a,"/PR:").concat(c,"/UI:").concat(d,"/S:").concat(u,"/C:").concat(s,"/I:").concat(o,"/A:").concat(i);switch(!0){case p>=9:t="Critical",n="border-purple-600";break;case p>=7:t="High",n="border-red-600";break;case p>=4:t="Medium",n="border-orange-activity";break;case p>=.1:t="Low",n="border-yellow-activity";break;default:t="None",n="border-blue-500"}return{severity:t,score:p,color:n,cvssString:h}},p=e=>{var t,n;return+(null!==(n=null===(t=e.new_permalinks)||void 0===t?void 0:t.items.filter(e=>(null==e?void 0:e.status)==="valid").reduce((e,t)=>{var n,r;return(null==t?void 0:t.bounty)?e+(null!==(r=null===(n=t.bounty)||void 0===n?void 0:n.amount)&&void 0!==r?r:0):e},0).toFixed(2))&&void 0!==n?n:0)}},50551:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let r=n(99920);n(57437),n(2265);let a=r._(n(40148));function l(e,t){var n;let r={loading:e=>{let{error:t,isLoading:n,pastDelay:r}=e;return null}};"function"==typeof e&&(r.loader=e);let l={...r,...t};return(0,a.default)({...l,modules:null==(n=l.loadableGenerated)?void 0:n.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},10912:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}});let r=n(55592);function a(e){let{reason:t,children:n}=e;if("undefined"==typeof window)throw new r.BailoutToCSRError(t);return n}},40148:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let r=n(57437),a=n(2265),l=n(10912),i=n(61481);function s(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(s(()=>null)),loading:null,ssr:!0},c=function(e){let t={...o,...e},n=(0,a.lazy)(()=>t.loader().then(s)),c=t.loading;function u(e){let s=c?(0,r.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,o=t.ssr?(0,r.jsxs)(r.Fragment,{children:["undefined"==typeof window?(0,r.jsx)(i.PreloadCss,{moduleIds:t.modules}):null,(0,r.jsx)(n,{...e})]}):(0,r.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(n,{...e})});return(0,r.jsx)(a.Suspense,{fallback:s,children:o})}return u.displayName="LoadableComponent",u}},61481:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return l}});let r=n(57437),a=n(58512);function l(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let n=(0,a.getExpectedRequestStore)("next/dynamic css"),l=[];if(n.reactLoadableManifest&&t){let e=n.reactLoadableManifest;for(let n of t){if(!e[n])continue;let t=e[n].files.filter(e=>e.endsWith(".css"));l.push(...t)}}return 0===l.length?null:(0,r.jsx)(r.Fragment,{children:l.map(e=>(0,r.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:n.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},83417:function(){},8511:function(){}}]);