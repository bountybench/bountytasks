(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3793],{94345:function(e,t,i){Promise.resolve().then(i.bind(i,74960))},44379:function(e,t,i){"use strict";var s=i(2265),l=i(99376),a=i(80605);t.Z=e=>{let{setMagicLinkAuthing:t}=e,i=(0,l.useRouter)();return(0,s.useEffect)(()=>{let e=new URLSearchParams(window.location.search);(async()=>{let i=e.get("token"),s=await (0,a.getSession)();if((null==s?void 0:s.error)==="MagicTokenExpired")return s.magic_token?(0,a.signOut)({callbackUrl:"/error/magic-link-expired?token=".concat(s.magic_token)}):(console.warn("Magic token expired, but no token found in session, forcing sign out."),(0,a.signOut)());if(!s&&i)try{await (0,a.signIn)("credentials",{token:i,redirect:!0})}catch(e){console.error("Sign-in error",e)}t(!1)})()},[i,t]),null}},74960:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return eC}});var s=i(57437),l=i(99376);i(83079);var a=i(12119),n=(0,a.$)("af517f9b9a221e0a43a294ac439e126507d8c4aa"),r=(0,a.$)("415d440a368e3e7dd9b33e032fb24f3fed80c2df"),o=(0,a.$)("4ff0f897be640699fb1c7d16d9a515bbd30b87f9"),c=(0,a.$)("9e0b8e9bcab138235158096c46ffd8cb0e168088"),d=(0,a.$)("4538faa5650b79f9fb3ffd6e817e18f9a3dfe98d"),m=(0,a.$)("6e810e8a3ff292b65245e4ba84ee5c993f7e3ad4"),u=(0,a.$)("90acb661998c4c1fc23377689b1dc59defa75a5a");(0,a.$)("864918dc143e2f178dcd2399b7e37d00f15dca90");var x=i(2265),h=i(79255),p=i(35217),v=i(51268),f=i(82082),b=i(77398),y=i.n(b),w=i(94081),j=e=>{let{id:t,label:i,options:l,value:a,onChange:n}=e;return(0,s.jsxs)("div",{className:"mx-auto flex flex-col gap-2",children:[(0,s.jsx)("label",{className:"text-sm text-white text-opacity-60",htmlFor:t,children:i}),(0,s.jsx)("div",{className:"mx-auto",id:t,children:(0,s.jsx)("div",{className:"items-cetner relative z-0 flex rounded-md border border-white border-opacity-10",children:l.map(e=>{let{label:t,value:i}=e;return(0,s.jsx)("button",{className:"-ml-px px-4 py-2 text-sm font-medium text-white first:rounded-l-md last:rounded-r-md focus:z-10 focus:outline-none sm:rounded-none ".concat(a===i?"bg-blue-600 hover:bg-blue-500":"bg-white bg-opacity-10 hover:bg-opacity-20"),onClick:()=>{n(i)},children:t},t)})})})]})},N=i(27648),g=i(72694),k=e=>{let{vulnerability:t,isVisible:i,isLoading:l,setVisible:a,onSubmit:n}=e,r=(0,x.useRef)(null),[o,c]=(0,x.useState)({attack_complexity:"L",attack_vector:"N",availability:"N",confidentiality:"N",integrity:"N",privileges_required:"N",scope:"U",user_interaction:"N"});if((0,x.useEffect)(()=>{t.cvss&&c(t.cvss)},[t.cvss]),(0,g.t$)(r,()=>{a(!1)}),i)return(0,s.jsx)("div",{className:"scrolling-touch fixed bottom-0 left-0 right-0 top-0 z-[999] h-full w-full overflow-auto bg-black bg-opacity-50 font-montserrat duration-700 ease-in-out",children:(0,s.jsx)("div",{className:"relative z-50 mx-auto my-auto h-full max-h-96 max-w-[42rem] px-3 py-12",children:(0,s.jsxs)("div",{className:"relative max-h-[80vh] max-w-xl overflow-auto rounded bg-10-percent py-6",ref:r,children:[(0,s.jsxs)("div",{className:"rounded-t border-b border-none p-3",children:[(0,s.jsxs)("h1",{className:"mb-4 text-center text-xl font-bold",children:["Severity: ",(0,f.SH)({...t,cvss:o}).severity," (",(0,f.SH)({...t,cvss:o}).score,")"]}),(0,s.jsx)("hr",{className:"bg-white opacity-10"})]}),(0,s.jsxs)("div",{className:"p-3",children:[(0,s.jsxs)("div",{className:"px-5 text-sm",children:["Need help?"," ",(0,s.jsx)(N.default,{href:"https://www.first.org/cvss/v3.1/user-guide",target:"_blank",className:"mx-auto text-sm text-blue-400 hover:underline",children:"Visit the CVSS user guide"}),"."]}),(0,s.jsx)("div",{className:"px-4",children:(0,s.jsx)("div",{className:"flex scale-90 flex-col",children:(0,s.jsxs)("div",{className:"flex flex-wrap gap-x-5 gap-y-4 pt-6",children:[(0,s.jsx)(j,{id:"attack-vector",label:"Attack Vector",options:[{label:"Network",value:"N"},{label:"Adjacent",value:"A"},{label:"Local",value:"L"},{label:"Physical",value:"P"}],value:o.attack_vector,onChange:e=>{c({...o,attack_vector:e})}}),(0,s.jsx)(j,{id:"attack-complexity",label:"Attack Complexity",options:[{label:"Low",value:"L"},{label:"High",value:"H"}],value:o.attack_complexity,onChange:e=>{c({...o,attack_complexity:e})}}),(0,s.jsx)(j,{id:"privileges-required",label:"Privileges Required",options:[{label:"None",value:"N"},{label:"Low",value:"L"},{label:"High",value:"H"}],value:o.privileges_required,onChange:e=>{c({...o,privileges_required:e})}}),(0,s.jsx)(j,{id:"user-interaction",label:"User Interaction",options:[{label:"None",value:"N"},{label:"Required",value:"R"}],value:o.user_interaction,onChange:e=>{c({...o,user_interaction:e})}}),(0,s.jsx)(j,{id:"scope",label:"Scope",options:[{label:"Unchanged",value:"U"},{label:"Changed",value:"C"}],value:o.scope,onChange:e=>{c({...o,scope:e})}}),(0,s.jsx)(j,{id:"confidentiality",label:"Confidentiality",options:[{label:"None",value:"N"},{label:"Low",value:"L"},{label:"High",value:"H"}],value:o.confidentiality,onChange:e=>{c({...o,confidentiality:e})}}),(0,s.jsx)(j,{id:"integrity",label:"Integrity",options:[{label:"None",value:"N"},{label:"Low",value:"L"},{label:"High",value:"H"}],value:o.integrity,onChange:e=>{c({...o,integrity:e})}}),(0,s.jsx)(j,{id:"availability",label:"Availability",options:[{label:"None",value:"N"},{label:"Low",value:"L"},{label:"High",value:"H"}],value:o.availability,onChange:e=>{c({...o,availability:e})}})]})})})]}),(0,s.jsxs)("div",{className:"rounded-b border-t border-none p-3",children:[(0,s.jsx)("button",{className:"float-right mr-6 w-32 rounded-md border border-bright-green border-transparent px-4 py-2 text-base font-medium text-white focus:outline-none sm:col-start-2 sm:text-sm ".concat(l?"pointer-events-none cursor-not-allowed bg-dark-green bg-opacity-50":"bg-dark-green hover:bg-bright-green"),onClick:async()=>{await n(o)},disabled:l,"aria-disabled":l,children:l?(0,s.jsx)(v.G,{icon:p.IJ7,className:"mx-auto animate-spin text-base text-white"}):(0,s.jsx)("span",{children:"Save"})}),(0,s.jsx)("button",{className:"float-right mr-6 mt-3 self-center rounded-md text-base font-medium text-white hover:text-blue-500 focus:outline-none sm:text-sm",onClick:()=>a(!1),children:"Cancel"})]})]})})})},_=i(32306),C=i(29054);let S=(0,x.createContext)(void 0),A=()=>{let e=(0,x.useContext)(S);if(void 0===e)throw Error("useConversation must be used within a ConversationProvider");return e},M=e=>{var t,i;let{children:l,vulnerabilityId:a,session:n}=e,[r,o]=(0,x.useState)(),[m,u]=(0,x.useState)([]),[h,p]=(0,x.useState)(""),[v,f]=(0,x.useState)(""),[b,y]=(0,x.useState)(null),[w,j]=(0,x.useState)(null),[N,g]=(0,x.useState)(null),[k,_]=(0,x.useState)(!1),[A,M]=(0,x.useState)([]),L=null==n?void 0:null===(t=n.user)||void 0===t?void 0:t.username;(0,x.useEffect)(()=>{(async()=>{try{var e,t,i,s,l;let a=((null==r?void 0:null===(t=r.activities)||void 0===t?void 0:null===(e=t.items)||void 0===e?void 0:e.filter(e=>(null==e?void 0:e.type)==="fix_submission"&&e.user))||[]).map(e=>{var t;return null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.id}).filter(e=>null==e?void 0:e.startsWith("github_")),n=(null==r?void 0:null===(s=r.repository)||void 0===s?void 0:null===(i=s.maintainers)||void 0===i?void 0:i.filter(e=>null==e?void 0:e.startsWith("github_")))||[],o=[...a,...n];if(null==r?void 0:null===(l=r.repository)||void 0===l?void 0:l.owner){let e=await d(r.repository.owner);(null==e?void 0:e.id.startsWith("github_"))&&o.push(e.id)}let c=Array.from(new Set(o)),m=await Promise.all(c.map(e=>d(e)));M(m)}catch(e){console.error("Error fetching conversation or processing fixers:",e)}})()},[r]);let G=async e=>e?40===e.length&&/[a-f0-9]{40}/.test(e)?"":"Invalid SHA format.":"Please enter a commit SHA.";(0,x.useEffect)(()=>{let e=async e=>{try{return(await d(e)).id}catch(e){return console.error("Failed to fetch user ID:",e),null}};(async()=>{var t,i,s,l,a;let o=await e(L),c=o&&(null==r?void 0:null===(i=r.repository)||void 0===i?void 0:null===(t=i.maintainers)||void 0===t?void 0:t.includes(o)),d=null==n?void 0:null===(a=n.user)||void 0===a?void 0:null===(l=a.groups)||void 0===l?void 0:l.includes(null==r?void 0:null===(s=r.repository)||void 0===s?void 0:s.owner),m=(null==n?void 0:n.user.username)===(null==r?void 0:r.repository.owner);c||d||m?_(!0):_(!1)})()},[a,r,n,L]);let T=L===(null==r?void 0:null===(i=r._author)||void 0===i?void 0:i.preferred_username),{isAdmin:E}=(0,C.d)(),H=(0,x.useCallback)(async()=>{try{var e,t;let i=await c(a);o(i);let s=null==i?void 0:null===(t=i.conversation)||void 0===t?void 0:null===(e=t.messages)||void 0===e?void 0:e.items;if(i&&s){let e=s.filter(e=>null!==e).sort((e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()).reduce((e,t,i,s)=>{let l=e.some(e=>e.body===t.body&&(t.body.startsWith("#followUp")||t.body.startsWith("#notifymaintainer")||t.body.startsWith("#fixFollowUp")||t.body.startsWith("#publish")));if(t.body.startsWith("#digestSent")){let i=new Date(t.createdAt).getTime()-3e5,l=s.filter(e=>e.body.startsWith("#digestSent")&&new Date(e.createdAt).getTime()>=i).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime());l.length>0&&l[0].id===t.id&&e.push(t)}else l||e.push(t);return e},[]);u(e)}}catch(e){console.error(e)}},[a]);return(0,s.jsx)(S.Provider,{value:{vulnerability:r,messages:m,fetchConversation:H,selected:h,setSelected:p,cve:b,setCve:y,comment:v,setComment:f,fix:w,setFix:j,duplicateId:N,setDuplicateId:g,isMaintainer:k,isAdmin:E,isResearcher:T,possibleFixers:A,validateSha:G},children:l})},L=e=>{let{vulnerability:t,updatePublicationDate:i}=e,[l,a]=(0,x.useState)(!1),[n,r]=(0,x.useState)(""),[o,c]=(0,x.useState)(!1),{fetchConversation:d}=A();(0,x.useEffect)(()=>{a(!1),c(!1)},[t]);let m=y().utc(null==t?void 0:t.scheduled_publish_date);if(t.visible)return null;let u=m.isValid(),h=u?"".concat(m.format("MMM Do YYYY")," UTC"):"Please set a valid date",f=y().utc(t.createdAt).add("90","days").format("YYYY[-]MM[-]DD"),b=y().utc(null==t?void 0:t.scheduled_publish_date).format("YYYY[-]MM[-]DD"),w="Please set a valid date";if(u){let e=y().utc(),t=m.diff(e,"days")+1;w=0===t?"today":"".concat(t," days remaining")}let j=e=>{let i=y().utc(e);if(i.isAfter(y()(f)))return{type:"error",message:"Must be earlier than ".concat(y()(f).format("DD[-]MM[-]YYYY")," (max 90 days from creation)")};if(i.isBefore(y()(b)))return{type:"error",message:"Must be later than ".concat(b," (min 45 days from creation)")};if(!i.isValid())return{type:"error",message:"Please enter a valid date"};let s=y().utc(i).diff(y().utc(null==t?void 0:t.scheduled_publish_date),"days");return s>1?{type:"success",message:"Extend by ".concat(s+1," days")}:{type:"empty",message:"".concat(s)}},N=async()=>{c(!0),await i(n).catch(e=>{console.log(e)}),await d(),c(!1)};return(0,s.jsx)("div",{className:"w-full font-medium",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex flex-row items-center",children:[(0,s.jsx)(v.G,{icon:p.eHv,className:"ml-0.5 mr-1 text-xs text-yellow-500"}),(0,s.jsx)("span",{children:"Publication Date"}),l?(0,s.jsxs)("div",{className:"-mt-[1px] mb-[3px] ml-2.5",children:[(0,s.jsx)("button",{id:"maintainer-save-type-button",className:"rounded-md border border-white border-opacity-10 bg-white bg-opacity-10 px-3 py-0.5 text-xs font-medium hover:border-opacity-20 hover:bg-opacity-20 disabled:cursor-default disabled:opacity-50",onClick:()=>N(),children:o?(0,s.jsx)(v.G,{icon:p.IJ7,className:"mx-auto animate-spin text-base text-white"}):(0,s.jsx)("span",{children:" Save"})}),(0,s.jsx)("button",{className:"ml-4 py-0.5 text-xs font-medium text-blue-500 hover:underline disabled:cursor-default disabled:opacity-50",onClick:()=>a(!1),children:"Cancel"})]}):(0,s.jsx)("button",{id:"maintainer-edit-type-button",className:"-mt-[1px] mb-[3px] ml-2.5 rounded-md border border-white border-opacity-10 bg-white bg-opacity-10 px-3 py-0.5 text-xs font-medium hover:border-opacity-20 hover:bg-opacity-20 disabled:cursor-default disabled:opacity-50",onClick:()=>{a(!0),r(m.format("YYYY[-]MM[-]DD"))},children:"Edit"})]}),l?(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{id:"release-date",type:"date",max:f,min:b,value:n,className:"default-border mt-2 w-40 rounded bg-[hsla(0,0%,100%,.07)] text-sm text-white",onChange:e=>r(e.target.value)}),"empty"!==j(n).type&&(0,s.jsxs)("span",{className:"mt-2 block text-xs ".concat("error"===j(n).type?"text-red-500":"text-bright-green"),children:[(0,s.jsx)(v.G,{icon:"error"===j(n).type?p.NBC:p.LEp,className:"mr-1"}),j(n).message]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"mt-1 text-white text-opacity-50",children:h}),u&&(0,s.jsx)("p",{className:"text-white text-opacity-50",children:w})]})]})})},G=e=>{var t,i,l,a;let{vulnerability:n}=e,r=+((null===(a=n.new_permalinks)||void 0===a?void 0:null===(l=a.items)||void 0===l?void 0:null===(i=l.filter(e=>{var t;return null!==e&&"invalid"!==e.status&&(null===(t=e.bounty)||void 0===t?void 0:t.amount)!==void 0}))||void 0===i?void 0:i.reduce((e,t)=>{var i,s;return e+(null!==(s=null===(i=t.bounty)||void 0===i?void 0:i.amount)&&void 0!==s?s:0)},0))||0).toFixed(2);return(null==n?void 0:null===(t=n.disclosure)||void 0===t?void 0:t.amount)===0?null:(0,s.jsxs)("div",{className:"w-full font-medium",children:["Disclosure Bounty",(0,s.jsx)("span",{className:"opacity-50",children:" "}),(0,s.jsx)("br",{}),(null==n?void 0:n.model_file)&&(null==n?void 0:n.status)==="pending"&&(0,s.jsx)("span",{className:"opacity-50",children:"up to "}),n.disclosure?(0,s.jsx)("span",{className:"opacity-50",children:r>0&&!n.patch_commit_sha?(0,s.jsxs)("span",{children:["$",n.disclosure.amount," to $",n.disclosure.amount+r]}):(0,s.jsxs)("span",{children:["$",n.disclosure.amount+r]})}):"N/A"]})};var T=e=>{var t,i,l,a,n,r,o,c,d,m,u,b,y,j,N,g,C,S,M,T,E,H,I,Y;let{vulnerability:V,updatePublicationDate:P,updateCwe:W,updateCvss:O}=e,{isAdmin:R,isMaintainer:B,fetchConversation:F}=A(),[D,U]=(0,x.useState)(!1),[Z,z]=(0,x.useState)(!1),[$,q]=(0,x.useState)(""),[J,X]=(0,x.useState)(!1),[Q,K]=(0,x.useState)(!1),ee=R||B&&!["invalid","not_applicable","informative","duplicate","spam","valid","self_closed"].includes(V.status||"");return(0,x.useEffect)(()=>{z(!1),U(!1),K(!1),(null==V?void 0:V.model_file)&&X(!0)},[V]),(0,s.jsx)("div",{id:"actions-and-stats",className:"w-full font-montserrat",children:(0,s.jsxs)("div",{id:"meta-container",className:"mt-5 space-y-4 text-sm font-medium md:mt-10 lg:m-0",children:[ee&&!J&&(0,s.jsx)(L,{vulnerability:V,updatePublicationDate:P}),V.cve&&"hidden"!==V.cve.status&&!J&&(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("span",{className:"font-medium",children:"CVE "}),(0,s.jsx)("br",{}),(0,s.jsxs)("div",{children:[(0,s.jsx)("a",{href:"https://nvd.nist.gov/vuln/detail/".concat(V.cve.id),target:"_blank",rel:"noopener noreferrer",className:"inline-block text-white text-opacity-50 hover:text-blue-400 hover:text-opacity-100",children:V.cve.id}),(0,s.jsxs)("span",{className:"block capitalize text-white text-opacity-50",children:["(",V.cve.status,V.cve.review_status===_.s1.Pending&&", under review",")"]})]})]}),V.cwe&&!J&&(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("span",{children:"Vulnerability Type"}),ee&&(0,s.jsx)(s.Fragment,{children:D?(0,s.jsxs)("div",{className:"-mt-[1px] mb-[3px] ml-2.5",children:[(0,s.jsx)("button",{id:"maintainer-save-type-button",className:"rounded-md border border-white border-opacity-10 bg-white bg-opacity-10 px-3 py-0.5 text-xs font-medium hover:border-opacity-20 hover:bg-opacity-20 disabled:cursor-default disabled:opacity-50",onClick:async()=>{try{z(!0),await W($),await F()}catch(e){console.error(e)}finally{z(!1)}},children:Z?(0,s.jsx)(v.G,{icon:p.IJ7,className:"mx-auto animate-spin text-base text-white"}):(0,s.jsx)("span",{children:" Save"})}),(0,s.jsx)("button",{className:"ml-4 py-0.5 text-xs font-medium text-blue-500 hover:underline disabled:cursor-default disabled:opacity-50",onClick:()=>U(!1),children:"Cancel"})]}):(0,s.jsx)("button",{id:"maintainer-edit-type-button",className:"-mt-[1px] mb-[3px] ml-2.5 rounded-md border border-white border-opacity-10 bg-white bg-opacity-10 px-3 py-0.5 text-xs font-medium hover:border-opacity-20 hover:bg-opacity-20 disabled:cursor-default disabled:opacity-50",onClick:()=>{var e;U(!0),q((null===(e=V.cwe)||void 0===e?void 0:e.id)||"")},children:"Edit"})})]}),D?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(w.Z,{repoName:V.repository.name,repoOwner:V.repository.owner,initialCwe:{id:(null===(t=V.cwe)||void 0===t?void 0:t.id)||"",label:(null===(i=V.cwe)||void 0===i?void 0:i.description)||(null===(l=V.cwe)||void 0===l?void 0:l.title)||"",value:(null===(a=V.cwe)||void 0===a?void 0:a.description)||(null===(n=V.cwe)||void 0===n?void 0:n.title)||""},onOptionChange:e=>q(e?e.id:"")})}):(0,s.jsxs)("a",{href:"https://cwe.mitre.org/data/definitions/".concat(V.cwe.number,".html"),className:"mt-1 text-white text-opacity-50 hover:text-blue-400 hover:text-opacity-100",children:["CWE-",V.cwe.number,":"," ",V.cwe.description||V.cwe.title]})]}),!J&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"w-full font-medium",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("span",{children:"Severity"}),ee&&(Q?(0,s.jsxs)("div",{className:"-mt-[1px] mb-[3px] ml-2.5",children:[(0,s.jsx)("button",{id:"maintainer-save-type-button",className:"rounded-md border border-white border-opacity-10 bg-white bg-opacity-10 px-3 py-0.5 text-xs font-medium hover:border-opacity-20 hover:bg-opacity-20 disabled:cursor-default disabled:opacity-50",children:Z?(0,s.jsx)(v.G,{icon:p.IJ7,className:"mx-auto animate-spin text-base text-white"}):(0,s.jsx)("span",{children:" Save"})}),(0,s.jsx)("button",{className:"ml-4 py-0.5 text-xs font-medium text-blue-500 hover:underline disabled:cursor-default disabled:opacity-50",onClick:()=>K(!1),children:"Cancel"})]}):(0,s.jsx)("button",{id:"maintainer-edit-severity-button",className:"-mt-[1px] mb-[3px] ml-2.5 rounded-md border border-white border-opacity-10 bg-white bg-opacity-10 px-3 py-0.5 text-xs font-medium hover:border-opacity-20 hover:bg-opacity-20 disabled:cursor-default disabled:opacity-50",onClick:()=>K(!0),children:"Edit"}))]}),Q?(0,s.jsx)(k,{vulnerability:V,isVisible:Q,setVisible:K,isLoading:Z,onSubmit:async e=>{z(!0),await O(e),await F(),z(!1)}}):(0,s.jsxs)("div",{className:"pt-0.5 text-white text-opacity-50",children:[(0,f.SH)(V).severity," (",(0,f.SH)(V).score,")",(0,s.jsxs)("div",{className:"mb-2 mt-2 flex w-[250px] flex-col text-xs font-normal",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("span",{children:"Attack vector"}),(0,s.jsx)("span",{className:"ml-auto",children:(0,f.M3)(null==V?void 0:null===(r=V.cvss)||void 0===r?void 0:r.attack_vector,"attackVector")})]}),(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("span",{children:"Attack complexity"}),(0,s.jsx)("span",{className:"ml-auto",children:(0,f.M3)(null==V?void 0:null===(o=V.cvss)||void 0===o?void 0:o.attack_complexity,"attackComplexity")})]}),(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("span",{children:"Privileges required"}),(0,s.jsx)("span",{className:"ml-auto",children:(0,f.M3)(null==V?void 0:null===(c=V.cvss)||void 0===c?void 0:c.privileges_required,"privilegesRequired")})]}),(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("span",{children:"User interaction"}),(0,s.jsx)("span",{className:"ml-auto",children:(0,f.M3)(null==V?void 0:null===(d=V.cvss)||void 0===d?void 0:d.user_interaction,"userInteraction")})]}),(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("span",{children:"Scope"}),(0,s.jsx)("span",{className:"ml-auto",children:(0,f.M3)(null==V?void 0:null===(m=V.cvss)||void 0===m?void 0:m.scope,"scope")})]}),(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("span",{children:"Confidentiality"}),(0,s.jsx)("span",{className:"ml-auto",children:(0,f.M3)(null==V?void 0:null===(u=V.cvss)||void 0===u?void 0:u.confidentiality,"confidentiality")})]}),(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("span",{children:"Integrity"}),(0,s.jsx)("span",{className:"ml-auto",children:(0,f.M3)(null==V?void 0:null===(b=V.cvss)||void 0===b?void 0:b.integrity,"integrity")})]}),(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("span",{children:"Availability"}),(0,s.jsx)("span",{className:"ml-auto",children:(0,f.M3)(null==V?void 0:null===(y=V.cvss)||void 0===y?void 0:y.availability,"availability")})]})]}),(0,s.jsxs)("a",{href:"https://cvss.js.org/#".concat((0,f.SH)(V).cvssString||""),target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-500 text-opacity-100 hover:underline",children:["Open in visual CVSS calculator"," ",(0,s.jsx)(v.G,{icon:p.Xjp,className:"ml-1"})]})]})]}),(0,s.jsxs)("div",{className:"w-full font-medium",children:[(0,s.jsx)("span",{children:"Registry"}),(0,s.jsx)("br",{}),(0,s.jsx)("span",{className:"opacity-50",children:null==V?void 0:null===(j=V.package_registry)||void 0===j?void 0:j.replace(/\b\w/g,e=>e.toUpperCase())})]}),(0,s.jsxs)("div",{className:"w-full font-medium",children:[(0,s.jsx)("span",{children:"Affected Version"}),(0,s.jsx)("br",{}),(0,s.jsx)("p",{className:"truncate opacity-50",children:null==V?void 0:V.affected_version})]})]}),(0,s.jsxs)("div",{className:"w-full font-medium",children:[(0,s.jsx)("span",{children:"Visibility"}),(0,s.jsx)("br",{}),(0,s.jsx)("span",{className:"opacity-50",children:V.visible?"Public":"Private"})]}),(0,s.jsxs)("div",{className:"w-full font-medium",children:[(0,s.jsx)("span",{children:"Status"}),(0,s.jsx)("br",{}),(0,s.jsx)("span",{className:"opacity-50",children:(0,f.d4)(V)})]}),(0,s.jsx)(G,{vulnerability:V}),(null==V?void 0:null===(N=V.fix)||void 0===N?void 0:N.items[0])&&(null==V?void 0:null===(C=V.fix)||void 0===C?void 0:null===(g=C.items[0])||void 0===g?void 0:g.amount)>0?(0,s.jsxs)("div",{className:"w-full font-medium",children:["Fix Bounty",(0,s.jsx)("br",{}),(0,s.jsxs)("span",{className:"opacity-50",children:["$",null==V?void 0:null===(M=V.fix)||void 0===M?void 0:null===(S=M.items[0])||void 0===S?void 0:S.amount]})]}):null,(null===(T=V._author)||void 0===T?void 0:T.id)&&(0,s.jsxs)("div",{className:"w-full font-medium",children:[(0,s.jsx)("div",{className:"mb-1",children:"Found by"}),(0,s.jsx)(h.Z,{className:"origin-left scale-90",userId:null===(E=V._author)||void 0===E?void 0:E.id})]}),V.fix&&(null===(H=V.fix.items[0])||void 0===H?void 0:H.activity)&&(0,s.jsxs)("div",{className:"w-full font-medium",children:[(0,s.jsx)("div",{className:"mb-1",children:"Fixed by"}),(0,s.jsx)(h.Z,{className:"origin-left scale-90",userId:null===(Y=V.fix.items[0])||void 0===Y?void 0:null===(I=Y.activity)||void 0===I?void 0:I.user_id})]})]})})},E=function(e){let{status:t,validationAt:i,resolvedAt:l}=e,a=x.useMemo(()=>"valid"===t||"invalid"===t?i:"spam"===t||"duplicate"===t||"informative"===t||"pending"===t||"not_applicable"===t||"self_closed"===t?l:i||l,[t,i,l]),n=x.useMemo(()=>{switch(t){case"valid":return"border-super-bright-green text-super-bright-green bg-super-bright-green bg-opacity-20";case"invalid":case"self_closed":case"not_applicable":case"spam":return"border-red-500 text-red-500 bg-red-500 bg-opacity-20 ";case"pending":return"border-yellow-500 text-yellow-500 bg-yellow-500 bg-opacity-20";case"duplicate":return"border-orange-500 text-orange-500 bg-orange-500 bg-opacity-20";case"informative":return"border-blue-500 text-blue-500 bg-blue-500 bg-opacity-20";default:return"border-white text-white"}},[t]),r=x.useMemo(()=>{switch(t){case"valid":return(0,s.jsx)(v.G,{icon:p.LEp});case"invalid":case"self_closed":case"not_applicable":return(0,s.jsx)(v.G,{icon:p.NBC});case"spam":return(0,s.jsx)(v.G,{icon:p.gPx});case"duplicate":return(0,s.jsx)(v.G,{icon:p.kZ_});case"pending":return(0,s.jsx)("div",{className:"inline-block h-1.5 w-1.5 self-center  rounded-full bg-yellow-400"});case"informative":return(0,s.jsx)(v.G,{icon:p.YHc});default:return(0,s.jsx)(v.G,{icon:p.Psp})}},[t]),o=x.useMemo(()=>t?"not_applicable"===t?"N/A":"self_closed"===t?"closed":t.charAt(0).toUpperCase()+t.slice(1):"",[t]);return(0,s.jsx)("span",{children:(0,s.jsxs)("span",{className:"mr-1 text-xs font-medium ".concat(n," rounded-full border px-2 py-1"),title:"self_closed"===t?"The report was marked as ".concat(o," by the researcher").concat(a?" on ".concat(new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})):"","."):"The report was marked as ".concat(o).concat(a?" on ".concat(new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})):"","."),children:[(0,s.jsx)("span",{className:"mr-2 self-center",children:r}),o]})})},H=i(84074),I=i(81740),Y=i(7533);i(92581),i(22235);let V=e=>{let{items:t,md:i}=e;if(!t||(null==t?void 0:t.length)===0)return null;let l=e=>{let t=e.lastIndexOf("/");return e.substring(t+1).replace("#"," ")};return(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{id:"occurrence-title",children:"Occurrences"}),t.map((e,t)=>(0,s.jsx)("div",{className:"permalinkMD ".concat(e.description?"mb-8":"mb-3 inline-block"),children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("a",{className:"permalink group mr-2 inline-flex cursor-pointer border-2 border-white border-opacity-10 bg-white bg-opacity-5 py-1 pl-2 pr-3 hover:bg-opacity-10 ".concat(e.description?"rounded-t border-b-0":"rounded"),href:e.url.startsWith("http://")||e.url.startsWith("https://")?e.url:"http://".concat(e.url),children:[(0,s.jsx)(Y.Z,{permalink:e.url}),(0,s.jsx)("p",{className:"self-center break-all text-white text-opacity-60 group-hover:text-blue-400 group-hover:underline",children:l(e.url)})]}),e.description&&(0,s.jsx)("div",{className:"markdown-body rounded rounded-tl-none border-2 border-white border-opacity-10 p-4",dangerouslySetInnerHTML:{__html:i.render(e.description)}})]})},t))]})},P=e=>{let{items:t}=e;return t&&0!==t.length?(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{id:"reference-title",children:"References"}),(0,s.jsx)("ul",{className:"ml-5 list-disc",children:t.map((e,t)=>(0,s.jsx)("li",{children:(0,s.jsx)("a",{className:"break-all text-blue-400 hover:underline",href:(null==e?void 0:e.url.startsWith("http://"))||(null==e?void 0:e.url.startsWith("https://"))?null==e?void 0:e.url:"http://".concat(null==e?void 0:e.url),children:(null==e?void 0:e.name)?e.name:null==e?void 0:e.url})},t))})]}):null};var W=e=>{var t,i,l,a,n,r,o,c,d,m,u,h,f,b;let{vulnerability:w,updateTitle:j}=e,[g,k]=(0,x.useState)(!1),[_,C]=(0,x.useState)(!1),[S,M]=(0,x.useState)(""),{isAdmin:L,isMaintainer:G}=A(),[T,Y]=(0,x.useState)(null),W=L||G&&!["invalid","not_applicable","informative","duplicate","spam","valid","self_closed"].includes(w.status||""),O=(()=>{if(w){var e,t;return w.impact?"".concat(null!==(e=w.read_me)&&void 0!==e?e:"","\n\n# Impact\n\n").concat(w.impact):null!==(t=w.read_me)&&void 0!==t?t:""}return""})(),R=null==w?void 0:null===(t=w.new_permalinks)||void 0===t?void 0:t.items.filter(e=>(null==e?void 0:e.status)!=="invalid"),B=new H._({highlight:function(e,t){if(t&&I.Z.getLanguage(t))try{return I.Z.highlight(t,e).value}catch(e){}try{return I.Z.highlightAuto(e).value}catch(e){}return""}});(0,x.useEffect)(()=>{M(""),C(!1),k(!1)},[w]);let F=async()=>{k(!0),j(S).then(()=>{}).catch(e=>{console.log(e),k(!1)})};return(0,x.useEffect)(()=>{(null==w?void 0:w.model_file_extension)&&Y(null==w?void 0:w.model_file_extension)},[w]),(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)("div",{id:"write-up",className:"rounded bg-white bg-opacity-10 p-5 lg:mb-2",children:(0,s.jsxs)("div",{className:"relative flex flex-col",children:[(0,s.jsx)("div",{className:"relative flex flex-row",children:_?(0,s.jsxs)("div",{className:"mb-3 max-w-full flex-grow text-2xl font-medium",children:[(0,s.jsx)("textarea",{value:S,onChange:e=>M(e.target.value),className:"w-full bg-transparent text-2xl font-medium"}),(0,s.jsxs)("div",{className:"flex flex-row",children:["in\xa0",T?(0,s.jsxs)("span",{children:[" ",T]}):(0,s.jsx)(N.default,{className:"underline hover:text-blue-400",target:"_blank",href:"https://github.com/".concat(null==w?void 0:null===(i=w.repository)||void 0===i?void 0:i.owner,"/").concat(null==w?void 0:null===(l=w.repository)||void 0===l?void 0:l.name),children:"".concat(null==w?void 0:null===(a=w.repository)||void 0===a?void 0:a.owner,"/").concat(null==w?void 0:null===(n=w.repository)||void 0===n?void 0:n.name)}),(0,s.jsx)("button",{id:"maintainer-save-title-button",className:"ml-3 mt-1 h-min self-center rounded-md border border-white border-opacity-10 bg-white bg-opacity-10 px-3 py-0.5 text-xs font-medium hover:border-opacity-20 hover:bg-opacity-20 disabled:cursor-default disabled:opacity-50",onClick:()=>F(),children:g?(0,s.jsx)(v.G,{icon:p.IJ7,className:"animate-spin text-base text-white"}):(0,s.jsx)("span",{children:"Save"})}),(0,s.jsx)("button",{className:"ml-2 mt-1 self-center py-0.5 text-xs font-medium text-blue-500 hover:underline disabled:cursor-default disabled:opacity-50",onClick:()=>C(!1),children:"Cancel"})]})]}):(0,s.jsx)("div",{className:"relative flex flex-row",children:(0,s.jsxs)("h1",{id:"title",className:"relative max-w-full flex-grow text-2xl font-medium",children:["".concat((null==w?void 0:w.title)||(null==w?void 0:null===(r=w.cwe)||void 0===r?void 0:r.description)||(null==w?void 0:null===(o=w.cwe)||void 0===o?void 0:o.title)," in "),T?(0,s.jsx)("span",{children:T}):(0,s.jsx)(N.default,{className:"underline hover:text-blue-400",target:"_blank",href:"https://github.com/".concat(null==w?void 0:null===(c=w.repository)||void 0===c?void 0:c.owner,"/").concat(null==w?void 0:null===(d=w.repository)||void 0===d?void 0:d.name),children:"".concat(null==w?void 0:null===(m=w.repository)||void 0===m?void 0:m.owner,"/").concat(null==w?void 0:null===(u=w.repository)||void 0===u?void 0:u.name)}),W&&(0,s.jsx)("button",{id:"maintainer-edit-title-button",className:"ml-2 rounded-md border border-white border-opacity-10 bg-white bg-opacity-10 px-3 py-0.5 text-xs font-medium hover:border-opacity-20 hover:bg-opacity-20 disabled:cursor-default disabled:opacity-50",onClick:()=>{var e,t;M((null==w?void 0:w.title)||(null==w?void 0:null===(e=w.cwe)||void 0===e?void 0:e.description)||(null==w?void 0:null===(t=w.cwe)||void 0===t?void 0:t.title)||""),C(!_)},children:"Edit"})]})})}),(0,s.jsxs)("div",{className:"mt-3 flex flex-row",children:[(0,s.jsx)(E,{status:null==w?void 0:w.status,resolvedAt:null!==(f=null==w?void 0:w.resolved_at)&&void 0!==f?f:"",validationAt:null!==(b=null==w?void 0:w.validation_at)&&void 0!==b?b:""}),(0,s.jsxs)("p",{className:"ml-3 mt-1 self-center text-xs font-medium text-white  text-opacity-60",children:["Reported on"," ",y()(null==w?void 0:w.createdAt).format("MMM Do YYYY")]})]}),(0,s.jsx)("hr",{className:"mb-3 mt-4 w-full border-b border-dotted border-white border-opacity-40"}),(0,s.jsx)("div",{className:"markdown-body",dangerouslySetInnerHTML:{__html:B.render(O)}}),(0,s.jsx)(V,{items:R,md:B}),(0,s.jsx)(P,{items:null==w?void 0:null===(h=w.references)||void 0===h?void 0:h.items})]})})})},O=i(76022),R=i.n(O),B=i(33145),F=e=>{let{message:t,vulnerability:i}=e;return["#permalinkValidated","#notifymaintainer","#github-issue","#followUp","#fixFollowUp","#securityPolicyPR","#24hour","#score","#manualFacilitation","#finalWarning","#notifymagicmaintainer","#manualOutreach","#triaged","#triageStarted","#cveAssigned","#cvePublished","#adminPublicationScheduleUpdated","#acknowledgementExtension","#publish","#reset","#digestSent"].some(e=>t.body.startsWith(e))?(0,s.jsx)("div",{className:"mr-4 hidden w-9 flex-shrink-0 sm:block"}):t.user&&t.user.preferred_username?(0,s.jsx)("div",{className:"hidden flex-shrink-0 sm:block",children:(0,s.jsx)(N.default,{href:"/users/".concat(t.user.preferred_username,"/"),children:(0,s.jsx)(B.default,{className:"mr-4 w-9 rounded-full",src:t.user.picture?t.user.picture:"https://github.com/".concat(t.user.preferred_username,".png"),alt:t.user.preferred_username,width:40,height:40})})}):(0,s.jsx)("div",{className:"hidden flex-shrink-0 sm:block",children:(0,s.jsx)(B.default,{className:"mr-5 hidden w-9 flex-shrink-0 rounded-full sm:block",src:"https://github.com/".concat(i.repository.owner,".png"),alt:i.repository.owner,width:40,height:40})})};let D=new H._({highlight:function(e,t){if(t&&I.Z.getLanguage(t))try{return I.Z.highlight(t,e).value}catch(e){}try{return I.Z.highlightAuto(e).value}catch(e){}return""}}),U=e=>{var t,i,l,a;let{message:n,vulnerability:r}=e,o=null==r?void 0:null===(t=r.repository)||void 0===t?void 0:t.maintainers,c=null==r?void 0:r._author,d=null==r?void 0:null===(i=r.repository)||void 0===i?void 0:i.owner,m=(null===(a=(l=n.user).groups)||void 0===a?void 0:a.includes("admin"))?{name:"Admin",color:"bg-blue-500 text-blue-500"}:o&&(null==o?void 0:o.includes(l.id))||l.preferred_username===d?{name:"Maintainer",color:"bg-yellow-400 text-yellow-400"}:c&&l.id===c.id?{name:"Researcher",color:"bg-red-600 text-red-600"}:null;return m?(0,s.jsx)(s.Fragment,{children:m&&(0,s.jsx)("p",{className:"ml-auto text-xs font-medium",style:{marginTop:"3px"},children:(0,s.jsx)("span",{className:"".concat(m.color," rounded-full bg-opacity-20 px-2 py-0.5"),children:m.name})})}):null};var Z=e=>{var t,i;let{message:l,vulnerability:a}=e;return(0,s.jsxs)("div",{className:"relative w-full rounded-xl border border-white border-opacity-10 bg-10-percent px-4 py-2.5 ".concat(R()["limit-width"]," ").concat(R()["message-body"]),children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[l.user&&l.user.preferred_username?(0,s.jsx)(N.default,{href:"/users/".concat(l.user.preferred_username,"/"),className:"".concat(R().username,"  mr-2 whitespace-nowrap"),children:l.user.name&&l.user.name.length>15?(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{className:"hidden sm:inline",children:null!==(t=l.user.name)&&void 0!==t?t:l.user.preferred_username}),(0,s.jsx)("span",{className:"inline sm:hidden",children:l.user.name.split(" ")[0]})]}):(0,s.jsx)("span",{children:null!==(i=l.user.name)&&void 0!==i?i:l.user.preferred_username})}):(0,s.jsxs)("div",{className:"mr-2 text-sm font-normal text-white text-opacity-60",children:["A\xa0"," ",(0,s.jsx)("a",{href:"https://github.com/".concat(a.repository.owner,"/").concat(a.repository.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:a.repository.owner+"/"+a.repository.name}),"\xa0maintainer"]}),(0,s.jsxs)("div",{className:"self-end text-xs opacity-50",style:{marginBottom:"1px"},children:[(0,s.jsx)("span",{className:"mr-1 hidden sm:inline",children:"commented"}),y()(l.createdAt).fromNow()]}),(0,s.jsx)(U,{message:l,vulnerability:a})]}),(0,s.jsx)("hr",{className:"my-3 w-full border-b border-white border-opacity-10"}),(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:D.render(l.body)},className:"markdown-body -mb-4 !font-montserrat !text-sm"})]})},z=i(17411);let $=new H._({highlight:function(e,t){if(t&&I.Z.getLanguage(t))try{return I.Z.highlight(t,e).value}catch(e){}try{return I.Z.highlightAuto(e).value}catch(e){}return""}}),q=e=>{let[,t,i]=e.split("|");switch(i){case"awarded":if(0==+t)return"The researcher's credibility has not been affected";if(0>+t)return"The researcher's credibility has decreased: ".concat(t);if(+t>0)return"The researcher's credibility has increased: +".concat(t);break;case"testimony":return"The researcher's credibility has slightly increased as a result of the maintainer's thanks: +".concat(t);case"cvss":return"The researcher has received a minor penalty to their credibility for miscalculating the severity: ".concat(t);case"cwe":return"The researcher has received a minor penalty to their credibility for misclassifying the vulnerability type: ".concat(t)}return""},J=(e,t)=>{var i,s;return null===(s=t.find(t=>{var i,s;return(null===(s=t.activity)||void 0===s?void 0:null===(i=s.user)||void 0===i?void 0:i.id)===e}))||void 0===s?void 0:null===(i=s.activity)||void 0===i?void 0:i.user},X=e=>{var t,i,l,a,n,r,o;let{message:c,vulnerability:d}=e,m=d.fixed_version,u=d.patch_commit_sha,x=null==d?void 0:null===(t=d.fix)||void 0===t?void 0:t.items,h=x?J(c.body.replace("#fixSelected",""),x):null;return(0,s.jsxs)("div",{className:"mt-1 w-full text-sm font-medium",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"h-7 w-7 rounded-full bg-bright-green",style:{padding:"6px 7px"},children:(0,s.jsx)(v.G,{icon:p.LEp,className:"text-white"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center",children:[c.user&&c.user.preferred_username?(0,s.jsx)(N.default,{href:"/users/".concat(c.user.preferred_username),className:"".concat(R().username," mr-1"),children:c.user.name||c.user.preferred_username}):(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["A"," ",(0,s.jsxs)("a",{href:"https://github.com/".concat(null==d?void 0:null===(i=d.repository)||void 0===i?void 0:i.owner,"/").concat(null==d?void 0:null===(l=d.repository)||void 0===l?void 0:l.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==d?void 0:null===(a=d.repository)||void 0===a?void 0:a.owner,"/",null==d?void 0:null===(n=d.repository)||void 0===n?void 0:n.name]})," ","maintainer"]}),(0,s.jsx)("span",{className:"font-normal opacity-60",children:"marked this as fixed"}),m&&(0,s.jsxs)("span",{className:"mx-1 text-white text-opacity-50",children:["in"," ",(0,s.jsx)("span",{className:"text-white text-opacity-100",children:m})]}),u&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"font-normal opacity-60",children:"with commit"}),(0,s.jsx)("a",{href:"https://www.github.com/".concat(null==d?void 0:null===(r=d.repository)||void 0===r?void 0:r.owner,"/").concat(null==d?void 0:null===(o=d.repository)||void 0===o?void 0:o.name,"/commit/").concat(u),className:"ml-1 break-words hover:text-blue-400 hover:underline",target:"_blank",rel:"noopener noreferrer",children:u.slice(0,6)})]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(c.createdAt).fromNow()})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-white text-opacity-50"})}),h?(0,s.jsxs)("div",{className:"mr-1 inline-block self-center",children:[(0,s.jsx)(N.default,{href:"/users/".concat(h.preferred_username,"/"),className:"".concat(R().username," mr-1"),children:h.name||h.preferred_username}),(0,s.jsx)("span",{className:"mr-3 font-normal opacity-60",children:"has been awarded the fix bounty"}),(0,s.jsx)(v.G,{icon:p.LEp,className:"text-xs text-super-bright-green"})]}):(0,s.jsxs)("div",{className:"inline-block self-center font-normal text-white text-opacity-60",children:["The fix bounty has been dropped",(0,s.jsx)(v.G,{icon:p.NBC,className:"ml-3 text-xs text-red-500 text-opacity-100"})]})]})]})},Q=e=>(0,s.jsx)("div",{style:{border:"1.5px solid rgba(255, 255, 255, 0.1)"},className:"relative z-10 mt-3 rounded-lg bg-10-percent px-4 py-2.5 font-normal ".concat(R().explanation),children:(0,s.jsx)("div",{className:"markdown-body !font-montserrat !text-sm",dangerouslySetInnerHTML:{__html:$.render(e)}})});var K=e=>{var t,i,l,a,n,r,o,c,d,m,u,x,h,f,b,w,j,g,k,_,C,S,A,M,L,G,T,E,H,I,Y,V,P,W,O,B,F,D,U,$,J,K,ee,et,ei,es,el,ea,en,er,eo,ec,ed,em,eu,ex,eh,ep,ev,ef,eb,ey,ew,ej,eN,eg,ek,e_,eC,eS,eA,eM,eL,eG,eT,eE,eH,eI,eY,eV,eP,eW,eO,eR,eB,eF,eD,eU,eZ,ez,e$,eq,eJ,eX,eQ,eK,e0,e1,e5,e3,e4,e2,e6,e8,e7,e9,te,tt,ti,ts,tl,ta,tn,tr,to,tc,td,tm,tu,tx,th,tp,tv,tf,tb,ty,tw,tj,tN,tg,tk,t_,tC,tS;let{message:tA,vulnerability:tM}=e,tL=(e,t)=>e.startsWith(t),tG=(e,t)=>e.replace(t,""),tT=null==tM?void 0:tM._author,tE=tG(tA.body,"#valid");if(!tA.is_status)return(0,s.jsx)(Z,{message:tA,vulnerability:tM});if(tL(tA.body,"#valid"))return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"mt-1 w-full text-sm font-medium",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"h-7 w-7 rounded-full bg-bright-green",style:{padding:"4px 7px"},children:(0,s.jsx)(v.G,{icon:p.LEp,className:"text-white"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center",children:[tA.user&&tA.user.preferred_username?(0,s.jsx)(N.default,{href:"/users/".concat(tA.user.preferred_username,"/"),className:"".concat(R().username),children:tA.user.name||tA.user.preferred_username}):(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["A"," ",(0,s.jsxs)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(t=tM.repository)||void 0===t?void 0:t.owner,"/").concat(null==tM?void 0:null===(i=tM.repository)||void 0===i?void 0:i.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==tM?void 0:null===(l=tM.repository)||void 0===l?void 0:l.owner,"/",null==tM?void 0:null===(a=tM.repository)||void 0===a?void 0:a.name]})," ","maintainer"]}),(0,s.jsx)("span",{className:"ml-0.5 font-normal opacity-60",children:"\xa0validated this vulnerability"}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]}),tE&&Q(tE),tT&&(0,s.jsxs)("div",{className:"mt-4 flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"mr-2 inline-block self-center text-sm font-normal",children:[(0,s.jsx)(N.default,{href:"/users/".concat(tT.preferred_username,"/"),className:"".concat(R().username," mr-1"),children:tT.name||tT.preferred_username}),(0,s.jsx)("span",{className:"mr-3 opacity-60",children:"has been awarded the disclosure bounty"}),(0,s.jsx)(v.G,{icon:p.LEp,className:"text-xs text-super-bright-green"})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-white text-opacity-50"})}),(0,s.jsx)("div",{className:"mr-2 inline-block self-center font-normal opacity-60",children:"The fix bounty is now up for grabs"})]})]})});if(tL(tA.body,"#24hour")){let e=(null==tM?void 0:null===(n=tM.repository)||void 0===n?void 0:n.securityIssueNumber)&&!(null==tM?void 0:tM.github_issue_number);return(0,s.jsxs)("div",{className:"mt-1 w-full text-sm font-medium",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),style:{padding:"1.5px",height:"24px"},children:(0,s.jsx)(v.G,{icon:p.b7W,className:"text-sm text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"mr-2 inline-block",children:[(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["We are processing your report and will contact the",(0,s.jsx)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(r=tM.repository)||void 0===r?void 0:r.owner,"/").concat(null==tM?void 0:null===(o=tM.repository)||void 0===o?void 0:o.name),className:"mx-1 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:(null==tM?void 0:null===(c=tM.repository)||void 0===c?void 0:c.owner.toLowerCase())===(null==tM?void 0:null===(d=tM.repository)||void 0===d?void 0:d.name.toLowerCase())?null==tM?void 0:null===(m=tM.repository)||void 0===m?void 0:m.owner:"".concat(null==tM?void 0:null===(u=tM.repository)||void 0===u?void 0:u.owner,"/").concat(null==tM?void 0:null===(x=tM.repository)||void 0===x?void 0:x.name)})," ","team within 24 hours."]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]}),e?(0,s.jsxs)("div",{className:"mt-5 flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),style:{paddingTop:"6px",paddingLeft:"0.5px",height:"30px"},children:(0,s.jsxs)("svg",{className:"",style:{fill:"rgb(255 255 255 / 50%)"},"aria-label":"Open Issue",viewBox:"0 0 16 16",version:"1.1",width:"16",height:"16",role:"img",children:[(0,s.jsx)("path",{d:"M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"}),(0,s.jsx)("path",{fillRule:"evenodd",d:"M8 0a8 8 0 100 16A8 8 0 008 0zM1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0z"})]})}),(0,s.jsxs)("div",{className:"mr-2 inline-block",children:[(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["A"," ",(0,s.jsx)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(h=tM.repository)||void 0===h?void 0:h.owner,"/").concat(null==tM?void 0:null===(f=tM.repository)||void 0===f?void 0:f.name,"/issues/").concat(null==tM?void 0:null===(b=tM.repository)||void 0===b?void 0:b.securityIssueNumber),className:"inline-block break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:"GitHub Issue"})," ","asking the maintainers to create a ",(0,s.jsx)("code",{children:"SECURITY.md"})," ","exists"]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]}):null]})}if(tL(tA.body,"#triageStarted"))return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),style:{padding:"1.5px",height:"24px"},children:(0,s.jsx)(v.G,{icon:p.b7W,className:"text-sm text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"mr-2 inline-block",children:[(0,s.jsx)("span",{className:"font-normal text-white text-opacity-60",children:"This report has now been passed to internal triage and should be resolved within 14 days."}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})});if(tL(tA.body,"#notifymaintainer"))return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),style:{padding:"1.5px",height:"24px"},children:(0,s.jsx)(v.G,{icon:p.FU$,className:"text-sm text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"mr-2 inline-block",children:[(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["We have contacted a member of the",(0,s.jsx)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(w=tM.repository)||void 0===w?void 0:w.owner,"/").concat(null==tM?void 0:null===(j=tM.repository)||void 0===j?void 0:j.name),className:"mx-1 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:(null==tM?void 0:null===(k=tM.repository)||void 0===k?void 0:null===(g=k.owner)||void 0===g?void 0:g.toLowerCase())===(null==tM?void 0:null===(C=tM.repository)||void 0===C?void 0:null===(_=C.name)||void 0===_?void 0:_.toLowerCase())?null==tM?void 0:null===(S=tM.repository)||void 0===S?void 0:S.owner:"".concat(null==tM?void 0:null===(A=tM.repository)||void 0===A?void 0:A.owner,"/").concat(null==tM?void 0:null===(M=tM.repository)||void 0===M?void 0:M.name)})," ","team and are waiting to hear back"]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})});if(tL(tA.body,"#seen"))return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"h-7 w-7 rounded-full bg-bright-green sm:-ml-1",style:{padding:"4px 6px"},children:(0,s.jsx)(v.G,{icon:p.Mdf,className:"text-white"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center",children:[tA.user&&tA.user.preferred_username?(0,s.jsx)(N.default,{href:"/users/".concat(tA.user.preferred_username,"/"),className:"username",children:tA.user.name||tA.user.preferred_username}):(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["A\xa0",(0,s.jsxs)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(L=tM.repository)||void 0===L?void 0:L.owner,"/").concat(null==tM?void 0:null===(G=tM.repository)||void 0===G?void 0:G.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==tM?void 0:null===(T=tM.repository)||void 0===T?void 0:T.owner,"/",null==tM?void 0:null===(E=tM.repository)||void 0===E?void 0:E.name]}),"\xa0maintainer"]}),(0,s.jsx)("span",{className:"ml-1 font-normal opacity-60",children:"has acknowledged this report"}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})});if(tL(tA.body,"#score")){let e=parseInt(tA.body.split("|")[1],10);return(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]," !ml-0.5 flex"),children:e>=0?(0,s.jsx)(v.G,{icon:p.Tab,size:"sm",className:"my-auto text-white text-opacity-50"}):(0,s.jsx)(v.G,{icon:p.a1Y,size:"sm",className:"my-auto text-white text-opacity-50"})}),(0,s.jsx)("div",{className:"mr-2 inline-block self-center text-sm font-normal",children:(0,s.jsx)("span",{className:"mr-3 opacity-60",children:q(tA.body)})})]})}else if(tL(tA.body,"#fixSelected"))return(0,s.jsx)(X,{message:tA,vulnerability:tM});else if(tL(tA.body,"#publicationScheduleUpdated")){let e=y().utc(tA.body.split("|")[2]).format("MMM Do YYYY");return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"ml-1 flex bg-black p-1",children:[(0,s.jsx)(v.G,{icon:p.Xcf,className:"text-white text-opacity-50"}),(0,s.jsxs)("div",{className:"ml-1 mr-1 inline-block self-end font-normal",children:[tA.user&&tA.user.preferred_username?(0,s.jsx)("a",{href:"/users/".concat(tA.user.preferred_username,"/"),className:"".concat(R().username," mx-1"),children:tA.user.name||tA.user.preferred_username}):(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["A"," ",(0,s.jsxs)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(H=tM.repository)||void 0===H?void 0:H.owner,"/").concat(null==tM?void 0:null===(I=tM.repository)||void 0===I?void 0:I.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==tM?void 0:null===(Y=tM.repository)||void 0===Y?void 0:Y.owner,"/",null==tM?void 0:null===(V=tM.repository)||void 0===V?void 0:V.name]})," ","maintainer"]}),(0,s.jsxs)("span",{className:"opacity-60",children:["set the scheduled publication date to ",e," UTC"]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})})}else if(tL(tA.body,"#publish")){let e=tG(tA.body,"#publish");return(0,s.jsxs)("div",{className:"mt-1 w-full text-sm font-medium",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"h-7 w-7 rounded-full bg-bright-green",style:{padding:"4px 7px"},children:(0,s.jsx)(v.G,{icon:p.QNf,className:"text-white"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center",children:[(0,s.jsx)("span",{className:"ml-0.5 font-normal opacity-60",children:"This vulnerability has now been published"}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]}),e&&Q(e)]})}else if(tL(tA.body,"#finalWarning")){let e="https://github.com/".concat(null==tM?void 0:null===(P=tM.repository)||void 0===P?void 0:P.owner,"/").concat(null==tM?void 0:null===(W=tM.repository)||void 0===W?void 0:W.name),t=(null==tM?void 0:null===(O=tM.repository)||void 0===O?void 0:O.owner.toLowerCase())===(null==tM?void 0:null===(B=tM.repository)||void 0===B?void 0:B.name.toLowerCase())?null==tM?void 0:null===(F=tM.repository)||void 0===F?void 0:F.owner:"".concat(null==tM?void 0:null===(D=tM.repository)||void 0===D?void 0:D.owner,"/").concat(null==tM?void 0:null===(U=tM.repository)||void 0===U?void 0:U.name);return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),style:{padding:"1.5px",height:"24px"},children:(0,s.jsx)(v.G,{icon:p.eHv,className:"text-sm text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"inline-block self-center",children:[(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["We have sent a warning to the"," ",(0,s.jsx)("a",{href:e,className:"break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:t})," ","team to inform them that this report will be published in 48 hours"]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})})}else if(tL(tA.body,"#github-issue")){let e=tA.body.split("#github-issue{{SPLIT}}")[1],t="https://github.com/".concat(null==tM?void 0:null===($=tM.repository)||void 0===$?void 0:$.owner,"/").concat(null==tM?void 0:null===(J=tM.repository)||void 0===J?void 0:J.name,"/issues/").concat(e);return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),style:{paddingTop:"6px",paddingLeft:"0.5px",height:"30px"},children:(0,s.jsxs)("svg",{style:{fill:"rgb(255 255 255 / 50%)"},"aria-label":"Open Issue",viewBox:"0 0 16 16",version:"1.1",width:"16",height:"16",role:"img",children:[(0,s.jsx)("path",{d:"M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"}),(0,s.jsx)("path",{fillRule:"evenodd",d:"M8 0a8 8 0 100 16A8 8 0 008 0zM1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0z"})]})}),(0,s.jsxs)("div",{className:"mr-2 inline-block self-center",children:[(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["We created a"," ",(0,s.jsx)("a",{href:t,className:"inline-block break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:"GitHub Issue"})," ","asking the maintainers to create a ",(0,s.jsx)("code",{children:"SECURITY.md"})]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})})}else if(tL(tA.body,"#followUp")){let e=tA.body.slice(-1),t="https://github.com/".concat(null==tM?void 0:null===(K=tM.repository)||void 0===K?void 0:K.owner,"/").concat(null==tM?void 0:null===(ee=tM.repository)||void 0===ee?void 0:ee.name),i=(null==tM?void 0:null===(et=tM.repository)||void 0===et?void 0:et.owner.toLowerCase())===(null==tM?void 0:null===(ei=tM.repository)||void 0===ei?void 0:ei.name.toLowerCase()),l="",a="";switch(e){case"2":l="second",a="We will try again in 7 days.";break;case"3":l="third",a="We will try again in 14 days.";break;case"4":l="fourth",a="We will send a final notification 48 hours before report publication.";break;default:l="",a="We will try again in 4 days."}return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),style:{padding:"1.5px",height:"24px"},children:(0,s.jsx)(v.G,{icon:p.FU$,className:"text-sm text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"mr-2 inline-block",children:[(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["We have sent a ",l," follow up to the"," ",(0,s.jsx)("a",{href:t,className:"break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:i?null==tM?void 0:null===(es=tM.repository)||void 0===es?void 0:es.owner:"".concat(null==tM?void 0:null===(el=tM.repository)||void 0===el?void 0:el.owner,"/").concat(null==tM?void 0:null===(ea=tM.repository)||void 0===ea?void 0:ea.name)})," ","team. ",a]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})})}else if(tL(tA.body,"#cveAssigned")){let e=tA.body.split("|")[1],t="https://www.cve.org/CVERecord?id=".concat(e);return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"h-7 w-7 rounded-full",style:{padding:"4px 9px",background:"rgb(125, 80, 208)"},children:(0,s.jsx)(v.G,{icon:p.O7Q,className:"text-white"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center",children:[(0,s.jsx)("a",{href:t,className:"ml-0.5 mr-1 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:e}),(0,s.jsx)("span",{className:"font-normal opacity-60",children:"assigned to this report."}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})})}else if(tL(tA.body,"#patchSubmitted")){let e=(e=>{try{var t,i;let s=null==tM?void 0:null===(i=tM.activities)||void 0===i?void 0:null===(t=i.items.filter(t=>(null==t?void 0:t.type)==="fix_submission"&&(null==t?void 0:t.user_id)===e)[0])||void 0===t?void 0:t.patch;if(!s)return!1;return new URL(s),s}catch(e){return!1}})(tA.user.id);return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"ml-1 bg-black p-1 ",children:[(0,s.jsx)(v.G,{icon:p.FPD,className:"mr-2 text-white text-opacity-50"}),(0,s.jsxs)("div",{className:" inline-block self-end font-normal",children:[(0,s.jsx)(N.default,{href:"/users/".concat(tA.user.preferred_username,"/"),className:"".concat(R().username," ml-1"),children:tA.user.name||tA.user.preferred_username}),(0,s.jsx)("span",{className:"opacity-60",children:" submitted a"}),e?(0,s.jsx)("div",{className:"inline-block",children:(0,s.jsx)("a",{target:"_blank",className:"mx-1 inline-block hover:text-blue-400 hover:underline",href:e,children:"patch"})}):(0,s.jsx)("div",{className:"mx-1 inline-block opacity-60",children:"patch"})]}),(0,s.jsx)("span",{className:"self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})})}else if(tL(tA.body,"#cvePublished")){let e=tA.body.split("|")[1],t="https://www.cve.org/CVERecord?id=".concat(e);return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"h-7 w-7 rounded-full bg-bright-green",style:{padding:"4px 9px"},children:(0,s.jsx)(v.G,{icon:p.O7Q,className:"text-white"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center",children:[(0,s.jsx)("a",{href:t,className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:e}),(0,s.jsx)("span",{className:"ml-1.5 font-normal opacity-60",children:"has now been published"}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})})}else if("#edit"===tA.body)return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"ml-1 bg-black p-1",children:[(0,s.jsx)(v.G,{icon:p.Xcf,className:"text-white text-opacity-50"}),(0,s.jsxs)("div",{className:"ml-1 mr-1 inline-block self-end font-normal",children:[tA.user&&tA.user.preferred_username?(0,s.jsx)(N.default,{href:"/users/".concat(tA.user.preferred_username,"/"),className:"".concat(R().username," ml-1"),children:tA.user.name||tA.user.preferred_username}):(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["A\xa0",(0,s.jsxs)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(en=tM.repository)||void 0===en?void 0:en.owner,"/").concat(null==tM?void 0:null===(er=tM.repository)||void 0===er?void 0:er.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==tM?void 0:null===(eo=tM.repository)||void 0===eo?void 0:eo.owner,"/",null==tM?void 0:null===(ec=tM.repository)||void 0===ec?void 0:ec.name]}),"\xa0maintainer"]}),(0,s.jsx)("span",{className:"opacity-60",children:" modified the report"})]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal  opacity-50",children:y()(tA.createdAt).fromNow()})]})});else if(tL(tA.body,"#informative")){let e=tA.body.replace("#informative","");return(0,s.jsxs)("div",{className:"mt-1 w-full text-sm font-medium",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"h-7 w-7  rounded-full bg-blue-500",style:{padding:"4px 11px"},children:(0,s.jsx)(v.G,{icon:p.YHc,className:"text-white"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center",children:[tA.user&&tA.user.preferred_username?(0,s.jsx)(N.default,{href:"/users/".concat(tA.user.preferred_username,"/"),className:"".concat(R().username),children:tA.user.name||tA.user.preferred_username}):(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["A\xa0",(0,s.jsxs)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(ed=tM.repository)||void 0===ed?void 0:ed.owner,"/").concat(null==tM?void 0:null===(em=tM.repository)||void 0===em?void 0:em.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==tM?void 0:null===(eu=tM.repository)||void 0===eu?void 0:eu.owner,"/",null==tM?void 0:null===(ex=tM.repository)||void 0===ex?void 0:ex.name]}),"\xa0maintainer"]}),(0,s.jsx)("span",{className:"font-normal opacity-60",children:"\xa0has marked this vulnerability as informative"}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]}),e&&Q(e),(0,s.jsxs)("div",{className:"mt-4 flex flex-row sm:-ml-1",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"inline-block self-center text-sm font-normal text-white text-opacity-60",children:["The disclosure bounty has been dropped",(0,s.jsx)(v.G,{icon:p.NBC,className:"ml-3 text-xs text-red-500 text-opacity-100"})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex flex-row sm:-ml-1",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"inline-block self-center text-sm font-normal text-white text-opacity-60",children:["The fix bounty has been dropped",(0,s.jsx)(v.G,{icon:p.NBC,className:"ml-3 text-xs text-red-500 text-opacity-100"})]})]})]})}else if(tL(tA.body,"#editdetails")){let e=tA.body.split("|"),t=e[1],i=e[2],l=e[3];return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"ml-1 flex bg-black p-1",children:[(0,s.jsx)(v.G,{icon:p.Xcf,className:"text-white text-opacity-50"}),(0,s.jsxs)("div",{className:"ml-2 inline-block self-end font-normal",children:[tA.user&&tA.user.preferred_username?(0,s.jsx)(N.default,{href:"/users/".concat(tA.user.preferred_username,"/"),className:"".concat(R().username," mr-1"),children:tA.user.name||tA.user.preferred_username}):(0,s.jsxs)("span",{className:"mr-1 font-normal text-white text-opacity-60",children:["A\xa0",(0,s.jsxs)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(eh=tM.repository)||void 0===eh?void 0:eh.owner,"/").concat(null==tM?void 0:null===(ep=tM.repository)||void 0===ep?void 0:ep.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==tM?void 0:null===(ev=tM.repository)||void 0===ev?void 0:ev.owner,"/",null==tM?void 0:null===(ef=tM.repository)||void 0===ef?void 0:ef.name]}),"\xa0maintainer"]}),(0,s.jsxs)("span",{className:"opacity-60",children:["modified the ",t," from ",i," to ",l]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal  opacity-50",children:y()(tA.createdAt).fromNow()})]})]})})}else if(tL(tA.body,"#self_closed")){let e=tA.body.replace("#self_closed","");return(0,s.jsxs)("div",{className:"mt-1 w-full text-sm font-medium",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"h-7 w-7 rounded-full bg-red-600",style:{padding:"4px 9px"},children:(0,s.jsx)(v.G,{icon:p.NBC,className:"text-white"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center",children:[tA.user&&tA.user.preferred_username?(0,s.jsx)(N.default,{href:"/users/".concat(tA.user.preferred_username,"/"),className:"".concat(R().username),children:tA.user.name||tA.user.preferred_username}):(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["A\xa0",(0,s.jsxs)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(eb=tM.repository)||void 0===eb?void 0:eb.owner,"/").concat(null==tM?void 0:null===(ey=tM.repository)||void 0===ey?void 0:ey.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==tM?void 0:null===(ew=tM.repository)||void 0===ew?void 0:ew.owner,"/",null==tM?void 0:null===(ej=tM.repository)||void 0===ej?void 0:ej.name]}),"\xa0maintainer"]}),(0,s.jsx)("span",{className:"ml-1 font-normal opacity-60",children:"has closed this report."}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]}),e&&Q(e),(0,s.jsxs)("div",{className:"mt-4 flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"inline-block self-center text-sm font-normal text-white text-opacity-60",children:["The disclosure bounty has been dropped",(0,s.jsx)(v.G,{icon:p.NBC,className:"ml-3 text-xs text-red-500 text-opacity-100"})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"inline-block self-center text-sm font-normal text-white text-opacity-60",children:["The fix bounty has been dropped",(0,s.jsx)(v.G,{icon:p.NBC,className:"ml-3 text-xs text-red-500 text-opacity-100"})]})]})]})}else if(tL(tA.body,"#duplicate")){let e=null==tM?void 0:null===(eN=tM.duplicate_of_vulnerability)||void 0===eN?void 0:eN.id,t=tA.body.replace("#duplicate",""),i="/bounties/".concat(e);return(0,s.jsxs)("div",{className:"mt-1 w-full text-sm font-medium",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"h-7 w-7 rounded-full bg-yellow-600",style:{padding:"3px 8px"},children:(0,s.jsx)(v.G,{icon:p.kZ_,className:"text-white"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center",children:[tA.user&&tA.user.preferred_username?(0,s.jsx)(N.default,{href:"/users/".concat(tA.user.preferred_username,"/"),className:"".concat(R().username),children:tA.user.name||tA.user.preferred_username}):(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["A\xa0",(0,s.jsxs)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(eg=tM.repository)||void 0===eg?void 0:eg.owner,"/").concat(null==tM?void 0:null===(ek=tM.repository)||void 0===ek?void 0:ek.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==tM?void 0:null===(e_=tM.repository)||void 0===e_?void 0:e_.owner,"/",null==tM?void 0:null===(eC=tM.repository)||void 0===eC?void 0:eC.name]}),"\xa0maintainer"]}),(0,s.jsx)("span",{className:"ml-1 font-normal opacity-60",children:"has marked this vulnerability as a duplicate"}),e&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"font-normal opacity-60",children:"\xa0of\xa0"}),(0,s.jsx)(N.default,{href:i,className:"hover:text-blue-400 hover:underline",children:e})]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]}),t&&Q(t),(0,s.jsxs)("div",{className:"mt-4 flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-white text-opacity-50 sm:-ml-1"})}),(0,s.jsxs)("div",{className:"inline-block self-center text-sm font-normal text-white text-opacity-60",children:["The disclosure bounty has been dropped",(0,s.jsx)(v.G,{icon:p.NBC,className:"ml-3 text-xs text-red-500 text-opacity-100"})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-white text-opacity-50 sm:-ml-1"})}),(0,s.jsxs)("div",{className:"inline-block  self-center text-sm font-normal text-white text-opacity-60",children:["The fix bounty has been dropped",(0,s.jsx)(v.G,{icon:p.NBC,className:"ml-3 text-xs text-red-500 text-opacity-100"})]})]})]})}else if(tL(tA.body,"#not_applicable")){let e=tA.body.replace("#not_applicable","");return(0,s.jsxs)("div",{className:"mt-1 w-full text-sm font-medium",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"h-7 w-7 rounded-full bg-red-600",style:{padding:"4px 9px"},children:(0,s.jsx)(v.G,{icon:p.NBC,className:"text-white"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center",children:[tA.user&&tA.user.preferred_username?(0,s.jsx)(N.default,{href:"/users/".concat(tA.user.preferred_username,"/"),className:"".concat(R().username),children:tA.user.name||tA.user.preferred_username}):(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["A\xa0",(0,s.jsxs)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(eS=tM.repository)||void 0===eS?void 0:eS.owner,"/").concat(null==tM?void 0:null===(eA=tM.repository)||void 0===eA?void 0:eA.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==tM?void 0:null===(eM=tM.repository)||void 0===eM?void 0:eM.owner,"/",null==tM?void 0:null===(eL=tM.repository)||void 0===eL?void 0:eL.name]}),"\xa0maintainer"]}),(0,s.jsx)("span",{className:"ml-1 font-normal opacity-60",children:"has marked this vulnerability as not applicable"}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]}),e&&Q(e),(0,s.jsxs)("div",{className:"mt-4 flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"inline-block self-center text-sm font-normal text-white text-opacity-60",children:["The disclosure bounty has been dropped",(0,s.jsx)(v.G,{icon:p.NBC,className:"ml-3 text-xs text-red-500 text-opacity-100"})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"inline-block self-center text-sm font-normal text-white text-opacity-60",children:["The fix bounty has been dropped",(0,s.jsx)(v.G,{icon:p.NBC,className:"ml-3 text-xs text-red-500 text-opacity-100"})]})]})]})}else if(tL(tA.body,"#invalid")){let e=tA.body.replace("#invalid","");return(0,s.jsxs)("div",{className:"mt-1 w-full text-sm font-medium",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"h-7 w-7 rounded-full bg-red-600",style:{padding:"4px 9px"},children:(0,s.jsx)(v.G,{icon:p.NBC,className:"text-white"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center",children:[tA.user&&tA.user.preferred_username?(0,s.jsx)(N.default,{href:"/users/".concat(tA.user.preferred_username,"/"),className:"".concat(R().username),children:tA.user.name||tA.user.preferred_username}):(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["A\xa0",(0,s.jsxs)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(eG=tM.repository)||void 0===eG?void 0:eG.owner,"/").concat(null==tM?void 0:null===(eT=tM.repository)||void 0===eT?void 0:eT.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==tM?void 0:null===(eE=tM.repository)||void 0===eE?void 0:eE.owner,"/",null==tM?void 0:null===(eH=tM.repository)||void 0===eH?void 0:eH.name]}),"\xa0maintainer"]}),(0,s.jsx)("span",{className:"ml-1 font-normal opacity-60",children:"has marked this vulnerability as not applicable"}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]}),e&&Q(e),(0,s.jsxs)("div",{className:"mt-4 flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"inline-block self-center text-sm font-normal text-white text-opacity-60",children:["The disclosure bounty has been dropped",(0,s.jsx)(v.G,{icon:p.NBC,className:"ml-3 text-xs text-red-500 text-opacity-100"})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"inline-block self-center text-sm font-normal text-white text-opacity-60",children:["The fix bounty has been dropped",(0,s.jsx)(v.G,{icon:p.NBC,className:"ml-3 text-xs text-red-500 text-opacity-100"})]})]})]})}else if(tL(tA.body,"#acknowledgementExtension")){let[e,t]=tA.body.split("|").slice(1).map(e=>y()(e).format("Do MMM YYYY"));return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"ml-1 flex bg-black p-1",children:[(0,s.jsx)(v.G,{icon:p.Xcf,className:"text-white text-opacity-50"}),(0,s.jsxs)("div",{className:"ml-1 mr-1 inline-block self-end font-normal",children:[(0,s.jsxs)("span",{className:"opacity-60",children:["The scheduled publication date was automatically extended from\xa0",e,"\xa0 to\xa0",t,"\xa0 due to the maintainers acknowledgement of the report"]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal  opacity-50",children:y()(tA.createdAt).fromNow()})]})]})})}else if(tL(tA.body,"#reset"))return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"ml-1 flex bg-black p-1",children:[(0,s.jsx)(v.G,{icon:p.Xcf,className:"text-white text-opacity-50"}),(0,s.jsxs)("div",{className:"ml-1 mr-1 inline-block self-end font-normal",children:[(0,s.jsx)("span",{className:"opacity-60",children:"A huntr admin reset this report to a pending state."}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal  opacity-50",children:y()(tA.createdAt).fromNow()})]})]})});else if(tL(tA.body,"#banned")){let e=tA.body.replace("#banned|","");return(0,s.jsxs)("div",{className:"mt-1 w-full text-sm font-medium sm:-ml-1",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"h-7 w-7 rounded-full bg-red-600",style:{padding:"4px 7px"},children:(0,s.jsx)(v.G,{icon:p.R3t,className:"text-white"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center font-normal text-white text-opacity-60",children:[tA.user&&tA.user.preferred_username?(0,s.jsx)(N.default,{href:"/users/".concat(tA.user.preferred_username,"/"),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:tA.user.name||tA.user.preferred_username}):(0,s.jsxs)("a",{href:"https://huntr.com/repos/".concat(null==tM?void 0:null===(eI=tM.repository)||void 0===eI?void 0:eI.owner,"/").concat(null==tM?void 0:null===(eY=tM.repository)||void 0===eY?void 0:eY.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==tM?void 0:null===(eV=tM.repository)||void 0===eV?void 0:eV.owner,"/",null==tM?void 0:null===(eP=tM.repository)||void 0===eP?void 0:eP.name]}),"\xa0has banned\xa0",tT?(0,s.jsx)(N.default,{href:"/users/".concat(tT.preferred_username),className:"".concat(R().entities),children:tT.name||tT.preferred_username}):(0,s.jsx)("span",{children:"ghost"}),"\xa0from disclosing in\xa0",(0,s.jsxs)(N.default,{href:"/repos/".concat(null==tM?void 0:null===(eW=tM.repository)||void 0===eW?void 0:eW.owner,"/").concat(null==tM?void 0:null===(eO=tM.repository)||void 0===eO?void 0:eO.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==tM?void 0:null===(eR=tM.repository)||void 0===eR?void 0:eR.owner,"/",null==tM?void 0:null===(eB=tM.repository)||void 0===eB?void 0:eB.name]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]}),e&&Q(e)]})}else if(tL(tA.body,"#spam")){let e=tA.body.replace("#spam","");return(0,s.jsxs)("div",{className:"mt-1 w-full text-sm font-medium sm:-ml-1",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"h-7 w-7 rounded-full bg-red-600",style:{padding:"4px 7px"},children:(0,s.jsx)(v.G,{icon:p.gPx,className:"text-white"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center",children:[tA.user&&tA.user.preferred_username?(0,s.jsx)(N.default,{href:"/users/".concat(tA.user.preferred_username,"/"),className:"".concat(R().username),children:tA.user.name||tA.user.preferred_username}):(0,s.jsxs)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(eF=tM.repository)||void 0===eF?void 0:eF.owner,"/").concat(null==tM?void 0:null===(eD=tM.repository)||void 0===eD?void 0:eD.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==tM?void 0:null===(eU=tM.repository)||void 0===eU?void 0:eU.owner,"/",null==tM?void 0:null===(eZ=tM.repository)||void 0===eZ?void 0:eZ.name]}),(0,s.jsx)("span",{className:"font-normal opacity-60",children:"\xa0has marked this vulnerability as spam"}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]}),e&&Q(e),(0,s.jsxs)("div",{className:"mt-4 flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"inline-block self-center text-sm font-normal text-white text-opacity-60",children:["The disclosure bounty has been dropped",(0,s.jsx)(v.G,{icon:p.NBC,className:"ml-3 text-xs text-red-500 text-opacity-100"})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"inline-block self-center text-sm font-normal text-white text-opacity-60",children:["The fix bounty has been dropped",(0,s.jsx)(v.G,{icon:p.NBC,className:"ml-3 text-xs text-red-500 text-opacity-100"})]})]})]})}else if(tL(tA.body,"#testimony")){let e=tM.testimony;return(0,s.jsxs)("div",{className:"mt-1 w-full text-sm font-medium",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"h-7 w-7 rounded-full bg-white",style:{padding:"4px 7px"},children:(0,s.jsx)(v.G,{icon:p.m6i,className:"text-red-500"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center",children:[tA.user&&tA.user.preferred_username?(0,s.jsx)(N.default,{href:"/users/".concat(tA.user.preferred_username,"/"),className:"".concat(R().username),children:tA.user.name||tA.user.preferred_username}):(0,s.jsxs)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(ez=tM.repository)||void 0===ez?void 0:ez.owner,"/").concat(null==tM?void 0:null===(e$=tM.repository)||void 0===e$?void 0:e$.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==tM?void 0:null===(eq=tM.repository)||void 0===eq?void 0:eq.owner,"/",null==tM?void 0:null===(eJ=tM.repository)||void 0===eJ?void 0:eJ.name]}),(0,s.jsx)("span",{className:"font-normal opacity-60",children:" gave praise"}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]}),e&&Q(e)]})}else if(tL(tA.body,"#permalinkValidated")){let e=tA.body.split("|")[2],t=e.split("/").pop();return(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),style:{paddingTop:"2px"},children:(0,s.jsx)(v.G,{icon:p.egO,className:"text-sm text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"mr-2 inline-block self-center text-sm font-normal",children:[(0,s.jsx)("a",{href:e,className:"".concat(R().username," inline"),children:t}),(0,s.jsx)("span",{className:"mr-3 opacity-60",children:" has been validated"}),(0,s.jsx)(v.G,{icon:p.LEp,className:"text-xs text-super-bright-green"})]})]})}else if(tL(tA.body,"#manualOutreach")){let e="https://github.com/".concat(null==tM?void 0:null===(eX=tM.repository)||void 0===eX?void 0:eX.owner,"/").concat(null==tM?void 0:null===(eQ=tM.repository)||void 0===eQ?void 0:eQ.name),t=(null==tM?void 0:null===(eK=tM.repository)||void 0===eK?void 0:eK.owner.toLowerCase())===(null==tM?void 0:null===(e0=tM.repository)||void 0===e0?void 0:e0.name.toLowerCase())?null==tM?void 0:null===(e1=tM.repository)||void 0===e1?void 0:e1.owner:"".concat(null==tM?void 0:null===(e5=tM.repository)||void 0===e5?void 0:e5.owner,"/").concat(null==tM?void 0:null===(e3=tM.repository)||void 0===e3?void 0:e3.name);return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),style:{padding:"1.5px",height:"24px"},children:(0,s.jsx)(v.G,{icon:p.eHv,className:"text-sm text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"mr-2 inline-block",children:[(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["We were unable to make contact with the\xa0",(0,s.jsx)("a",{href:e,className:"break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:t}),"\xa0team automatically, our community manager will try to reach out to them instead."]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})})}else if(tL(tA.body,"#notifymagicmaintainer")){let e="https://github.com/".concat(null==tM?void 0:null===(e4=tM.repository)||void 0===e4?void 0:e4.owner,"/").concat(null==tM?void 0:null===(e2=tM.repository)||void 0===e2?void 0:e2.name),t="".concat(e,"/security/policy"),i=(null==tM?void 0:null===(e6=tM.repository)||void 0===e6?void 0:e6.owner.toLowerCase())===(null==tM?void 0:null===(e8=tM.repository)||void 0===e8?void 0:e8.name.toLowerCase())?null==tM?void 0:null===(e7=tM.repository)||void 0===e7?void 0:e7.owner:"".concat(null==tM?void 0:null===(e9=tM.repository)||void 0===e9?void 0:e9.owner,"/").concat(null==tM?void 0:null===(te=tM.repository)||void 0===te?void 0:te.name);return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),style:{padding:"1.5px",height:"24px"},children:(0,s.jsx)(v.G,{icon:p.FU$,className:"text-sm text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"mr-2 inline-block",children:[(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["We have sent a magic link to the\xa0",(0,s.jsx)("a",{href:e,className:"break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:i}),"\xa0team via the email provided in their\xa0",(0,s.jsx)("a",{href:t,className:"break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:"security policy"})]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})})}else if(tL(tA.body,"#manualFacilitation")){let e="https://github.com/".concat(null==tM?void 0:null===(tt=tM.repository)||void 0===tt?void 0:tt.owner,"/").concat(null==tM?void 0:null===(ti=tM.repository)||void 0===ti?void 0:ti.name),t=(null==tM?void 0:null===(ts=tM.repository)||void 0===ts?void 0:ts.owner.toLowerCase())===(null==tM?void 0:null===(tl=tM.repository)||void 0===tl?void 0:tl.name.toLowerCase())?null==tM?void 0:null===(ta=tM.repository)||void 0===ta?void 0:ta.owner:"".concat(null==tM?void 0:null===(tn=tM.repository)||void 0===tn?void 0:tn.owner,"/").concat(null==tM?void 0:null===(tr=tM.repository)||void 0===tr?void 0:tr.name);return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),style:{padding:"1.5px",height:"24px"},children:(0,s.jsx)(v.G,{icon:p.eHv,className:"text-sm text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"inline-block self-center",children:[(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["This report requires manual facilitation, a member of staff will reach out to the\xa0",(0,s.jsx)("a",{href:e,className:"break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:t}),"\xa0team."]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})})}else if(tL(tA.body,"#fixFollowUp")){let e="https://github.com/".concat(null==tM?void 0:null===(to=tM.repository)||void 0===to?void 0:to.owner,"/").concat(null==tM?void 0:null===(tc=tM.repository)||void 0===tc?void 0:tc.name),t=(null==tM?void 0:null===(td=tM.repository)||void 0===td?void 0:td.owner.toLowerCase())===(null==tM?void 0:null===(tm=tM.repository)||void 0===tm?void 0:tm.name.toLowerCase())?null==tM?void 0:null===(tu=tM.repository)||void 0===tu?void 0:tu.owner:"".concat(null==tM?void 0:null===(tx=tM.repository)||void 0===tx?void 0:tx.owner,"/").concat(null==tM?void 0:null===(th=tM.repository)||void 0===th?void 0:th.name),i=tA.body.endsWith("2")?"second":tA.body.endsWith("3")?"third and final":"",l=tA.body.endsWith("1")?"We will try again in 7 days.":tA.body.endsWith("2")?"We will try again in 10 days.":tA.body.endsWith("3")?"This report is now considered stale.":"";return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),style:{padding:"1.5px",height:"24px"},children:(0,s.jsx)(v.G,{icon:p.FU$,className:"text-sm text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"mr-2 inline-block self-center",children:[(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["We have sent a ",i," fix follow up to the\xa0",(0,s.jsx)("a",{href:e,className:"break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:t}),"\xa0team. ",l]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})})}else if(tL(tA.body,"#securityPolicyPR")){let e=tA.body.split("#securityPolicyPR-")[1],t="https://github.com/".concat(null==tM?void 0:null===(tp=tM.repository)||void 0===tp?void 0:tp.owner,"/").concat(null==tM?void 0:null===(tv=tM.repository)||void 0===tv?void 0:tv.name,"/pull/").concat(e),i="https://github.com/".concat(null==tM?void 0:null===(tf=tM.repository)||void 0===tf?void 0:tf.owner,"/").concat(null==tM?void 0:null===(tb=tM.repository)||void 0===tb?void 0:tb.name),l=(null==tM?void 0:null===(ty=tM.repository)||void 0===ty?void 0:ty.owner.toLowerCase())===(null==tM?void 0:null===(tw=tM.repository)||void 0===tw?void 0:tw.name.toLowerCase())?null==tM?void 0:null===(tj=tM.repository)||void 0===tj?void 0:tj.owner:"".concat(null==tM?void 0:null===(tN=tM.repository)||void 0===tN?void 0:tN.owner,"/").concat(null==tM?void 0:null===(tg=tM.repository)||void 0===tg?void 0:tg.name);return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"bg-black p-1 pl-2",children:(0,s.jsx)(v.G,{icon:z.zhw,className:"text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center",children:[(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["We have opened a\xa0",(0,s.jsx)("a",{href:t,className:"inline-block break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:"pull request"}),"\xa0with a ",(0,s.jsx)("code",{children:"SECURITY.md"})," for\xa0",(0,s.jsx)("a",{href:i,className:"break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:l}),"\xa0to merge."]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})})}else if(tL(tA.body,"#adminPublicationScheduleUpdated")){let e=y()(tA.body.split("|")[1]).format("Do MMM YYYY"),t=y()(tA.body.split("|")[2]).format("Do MMM YYYY");return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"ml-1 flex bg-black p-1",children:[(0,s.jsx)(v.G,{icon:p.Xcf,className:"text-white text-opacity-50"}),(0,s.jsxs)("div",{className:"ml-1 mr-1 inline-block self-end font-normal",children:[(0,s.jsxs)("span",{className:"opacity-60",children:["A huntr admin modified the scheduled publication date from"," ",e," to ",t]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal  opacity-50",children:y()(tA.createdAt).fromNow()})]})]})})}else if(tL(tA.body,"#triaged"))return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"h-7 w-7 rounded-full",style:{padding:"4px 6px",background:"#515151"},children:(0,s.jsx)(v.G,{icon:p.Mdf,className:"text-white"})}),(0,s.jsxs)("div",{className:"mx-2 inline-block self-center",children:[(0,s.jsx)("span",{className:"font-normal text-white text-opacity-60",children:"A huntr security researcher has marked the report as triaged"}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})});else if(tL(tA.body,"#digestSent"))return(0,s.jsx)("div",{className:"mt-1 w-full text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"".concat(R()["log-icon"]),style:{padding:"1.5px",height:"24px"},children:(0,s.jsx)(v.G,{icon:p.FU$,className:"text-sm text-white text-opacity-50"})}),(0,s.jsxs)("div",{className:"mr-2 inline-block",children:[(0,s.jsxs)("span",{className:"font-normal text-white text-opacity-60",children:["We have notified the"," ",(0,s.jsxs)("a",{href:"https://github.com/".concat(null==tM?void 0:null===(tk=tM.repository)||void 0===tk?void 0:tk.owner,"/").concat(null==tM?void 0:null===(t_=tM.repository)||void 0===t_?void 0:t_.name),className:"ml-0.5 break-words font-medium text-white text-opacity-100 hover:text-blue-400 hover:underline",children:[null==tM?void 0:null===(tC=tM.repository)||void 0===tC?void 0:tC.owner,"/",null==tM?void 0:null===(tS=tM.repository)||void 0===tS?void 0:tS.name]})," ","maintainers about this report in their weekly follow-up"]}),(0,s.jsx)("span",{className:"ml-1 self-end whitespace-nowrap text-xs font-normal opacity-50 ",children:y()(tA.createdAt).fromNow()})]})]})});return(0,s.jsxs)("div",{className:"relative w-full rounded-xl border border-white border-opacity-10 bg-10-percent px-4 py-2.5 ".concat(R()["limit-width"]),children:[(0,s.jsx)("p",{className:"text-sm ".concat(R().example),children:tA.body}),(0,s.jsx)("div",{className:"self-end text-xs opacity-50",children:y()(tA.createdAt).fromNow()})]})},ee=e=>{let{}=e,{vulnerability:t,messages:i,fetchConversation:l}=A();return(0,x.useEffect)(()=>{l()},[l]),(0,s.jsx)("div",{className:"mb-5 flex w-full flex-wrap space-y-12 font-montserrat",children:(0,s.jsx)("div",{className:"relative w-full ".concat(R()["messages-container"]),children:null==i?void 0:i.map(e=>(0,s.jsxs)("div",{className:"".concat(R()["message-box"]," relative my-5 flex flex-row last:mb-0"),children:[(0,s.jsx)(F,{message:e,vulnerability:t}),(0,s.jsx)(K,{message:e,vulnerability:t})]},e.id))})})},et=i(5515),ei=i.n(et),es=i(80605),el=(0,a.$)("c8bf811e4f860edbeb93c794f9c2fa5751fc269f"),ea=(0,a.$)("b594733a89b0b1e2223e83973a80d11873c7cfbd"),en=(0,a.$)("f894f038e4b9334633e8b9e13f80b915c7280e3d"),er=(0,a.$)("6124702a078e1ff51ef126909571ded316a70b7f"),eo=(0,a.$)("a75a3063fa2b28c354c2da989128ff852ea1cd28"),ec=(0,a.$)("7ed502b73848af465d69b0020cba0f10653f7602"),ed=i(7409),em=i(3985),eu=i(86691),ex=e=>{var t,i,l,a;let{}=e,[n,r]=(0,x.useState)(!1),{selected:o,comment:c,cve:d,vulnerability:m,setComment:u,fetchConversation:h,setSelected:f,fix:b,duplicateId:y}=A(),w=()=>{u(""),f(""),h(),r(!1)},{data:j}=(0,es.useSession)(),N=null==j?void 0:null===(t=j.user)||void 0===t?void 0:t.username,g=null==m?void 0:null===(i=m.conversation)||void 0===i?void 0:i.id,k=["Thank researcher","","Ban researcher","Mark as not applicable"].includes(o)&&!c.length,_="Fix"===o&&!((null==b?void 0:null===(l=b.sha)||void 0===l?void 0:l.length)===40&&(null==b?void 0:null===(a=b.version)||void 0===a?void 0:a.length)>0),C="Mark as duplicate"===o&&!y,S=async()=>{r(!0);try{var e,t,i,s,l,a;"Request a fix"===o||""===o?await ec(c,g,N):"Mark as seen"===o?await el(null==m?void 0:m.id):"Ban researcher"===o||("Fix"===o?await ea(null==m?void 0:m.id,null==b?void 0:b.fixer_id,null==b?void 0:b.sha,null==b?void 0:b.version)?(0,eu.L9)({event:"Mark as fixed",properties:{vulnerability:m},userId:null==j?void 0:null===(e=j.user)||void 0===e?void 0:e.id}):(0,ed.Am)("Error: the patch commit SHA submitted could not be found in the vulnerable repository, please check and try again.",{type:"error",autoClose:1e4}):"Mark as valid"===o?(await er({vulnerabilityId:null==m?void 0:m.id,status:em.Jb.Valid,comment:c,assign_cve:null==d?void 0:d.assign_cve}),(0,eu.L9)({event:"Marked as valid.",properties:{vulnerability:m},userId:null==j?void 0:null===(t=j.user)||void 0===t?void 0:t.id})):"Mark as not applicable"===o?(await er({vulnerabilityId:null==m?void 0:m.id,status:em.Jb.NotApplicable,comment:c}),(0,eu.L9)({event:"Marked as not applicable.",properties:{vulnerability:m},userId:null==j?void 0:null===(i=j.user)||void 0===i?void 0:i.id})):"Mark as informative"===o?(await er({vulnerabilityId:null==m?void 0:m.id,status:em.Jb.Informative,comment:c}),(0,eu.L9)({event:"Marked as informative.",properties:{vulnerability:m},userId:null==j?void 0:null===(s=j.user)||void 0===s?void 0:s.id})):"Mark as waste of time"===o?(await er({vulnerabilityId:null==m?void 0:m.id,status:em.Jb.Spam,comment:c}),(0,eu.L9)({event:"Marked as spam.",properties:{vulnerability:m},userId:null==j?void 0:null===(l=j.user)||void 0===l?void 0:l.id})):"Mark as duplicate"===o?(await er({vulnerabilityId:null==m?void 0:m.id,status:em.Jb.Duplicate,comment:c,duplicateId:y}),(0,eu.L9)({event:"Mark as duplicate.",properties:{vulnerability:m},userId:null==j?void 0:null===(a=j.user)||void 0===a?void 0:a.id})):"Thank researcher"===o&&await eo(c,null==m?void 0:m.id))}catch(e){(0,ed.Am)("Error: ".concat(e.message),{type:"error"}),console.error(e)}finally{w()}};return(0,s.jsx)("div",{className:"z-10 !mt-2 ml-auto",children:(0,s.jsx)("button",{id:"comment-btn",style:{minWidth:"80px"},onClick:S,className:"float-right mt-3 h-8 rounded-md border border-bright-green bg-dark-green px-2.5 py-1.5 text-xs font-medium hover:bg-bright-green disabled:cursor-default disabled:opacity-50 disabled:hover:bg-dark-green",disabled:n||k||_||C||"Fix and Publish"===o,children:n?(0,s.jsx)(v.G,{icon:p.IJ7,className:"mx-auto animate-spin text-base text-white"}):(0,s.jsx)("span",{children:o&&!["Thank researcher","Request a fix","Ban researcher"].includes(o)&&c.length?"".concat(o," with comment"):o||"Comment"})})})};let eh=new H._({highlight:function(e,t){if(t&&I.Z.getLanguage(t))try{return I.Z.highlight(t,e).value}catch(e){}try{return I.Z.highlightAuto(e).value}catch(e){}return""}});var ep=e=>{var t,i;let{}=e,{vulnerability:l,selected:a,fetchConversation:n,comment:r,setComment:o}=A();(0,x.useEffect)(()=>{n()},[n]);let{data:c}=(0,es.useSession)(),[d,m]=(0,x.useState)(!1),[u,h]=(0,x.useState)(null),p=!c||"Fix"===a||"Mark as seen"===a,v=(()=>{switch(a){case"Mark as not applicable":return"[required] Please tell the researcher how they can improve";case"Ban researcher":return"[required] Please tell the researcher why they're being banned";case"Fix":case"Mark as seen":return"You cannot comment with this action";default:return"Write a comment (supports markdown)."}})();return((0,x.useEffect)(()=>{l&&l.conversation&&l.conversation.id&&h(l.conversation.id)},[l]),c)?u?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{id:"input-container",className:"mt-7 flex w-full flex-row font-montserrat",children:[(0,s.jsx)("div",{className:"mt-[-3px] flex flex-col",children:(null==c?void 0:null===(t=c.user)||void 0===t?void 0:t.image)?(0,s.jsx)(B.default,{className:"mr-4 hidden h-10 w-10 flex-shrink-0 rounded-full sm:block",width:40,height:40,src:c.user.image,alt:""}):(0,s.jsx)(B.default,{className:"mr-4 hidden h-10 w-10 flex-shrink-0 rounded-full sm:block",width:40,height:40,src:"https://github.com/".concat(null==l?void 0:null===(i=l.repository)||void 0===i?void 0:i.owner,".png"),alt:""})}),(0,s.jsxs)("div",{className:"flex w-full flex-col",children:[(0,s.jsx)("div",{className:"mb-1.5 flex flex-row text-sm",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{className:"ml-1 py-1.5 pr-3 text-white hover:text-opacity-100 ".concat(d?"text-opacity-50":"text-opacity-100"),onClick:()=>m(!1),children:"Write"}),(0,s.jsx)("button",{className:"px-3 py-1.5 text-white hover:text-opacity-100 ".concat(d?"text-opacity-100":"text-opacity-50"),onClick:()=>m(!0),children:"Preview"})]})}),d?(0,s.jsx)("div",{id:"markdown",className:"block min-h-20 w-full rounded-xl border-none bg-white bg-opacity-10 p-2 px-4 py-2.5 text-left font-montserrat text-sm text-white placeholder-white placeholder-opacity-30",style:{minHeight:"100px"},children:(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:eh.render(r)},className:"markdown-body -mb-4 !font-montserrat !text-sm"})}):(0,s.jsx)("textarea",{id:"message-input",value:r,onChange:e=>o(e.target.value),placeholder:v,disabled:p,className:"block w-full rounded border-none bg-white bg-opacity-[7%] px-4 py-2.5 font-montserrat text-sm text-white placeholder-white placeholder-opacity-30 ".concat(p?"cursor-not-allowed opacity-70":""),rows:4})]})]}),(0,s.jsx)(ex,{})]}):null:(0,s.jsxs)("div",{className:"mt-7 w-full rounded-r border-l-4 border-yellow-400 bg-white bg-opacity-10 p-6 text-sm text-white",children:[(0,s.jsx)("button",{className:"underline hover:text-blue-500",onClick:()=>(0,es.signIn)("cognito"),children:"Sign in"}),"\xa0to join this conversation"]})},ev=e=>{let{}=e,{vulnerability:t,selected:i,setSelected:l,isAdmin:a,isMaintainer:n}=A(),[r,o]=(0,x.useState)({visible:!1,mouseLocation:""}),[c,d]=(0,x.useState)({visible:!1,mouseLocation:{title:"Valid",explanation:"This report describes a previously unknown vulnerability."}});if(!t||!n&&!a)return null;let m=()=>"valid"===t.status&&!t.patch_commit_sha,u=()=>{let e=[];return"pending"!==t.status||t.seen||e.push("Mark as seen"),"spam"===t.status||t.testimony||e.push("Thank researcher"),e},{status:h,patch_commit_sha:p}=t,v=["invalid","informative","duplicate","spam","not_applicable","self_closed"].includes(h)||"valid"===h&&p,f=e=>{l(e),o({visible:!1,mouseLocation:""}),d({visible:!1,mouseLocation:{title:"Valid",explanation:"This report describes a previously unknown vulnerability."}})};return(0,s.jsx)("div",{children:""===i&&(0,s.jsxs)("div",{className:"my-4 flex flex-row font-montserrat sm:ml-14",children:[u().length>0&&(0,s.jsxs)("div",{className:"relative z-30 mr-2",children:[(0,s.jsxs)("button",{id:"dropdown-menu-button",type:"button",className:"focus:none group inline-flex w-full justify-center rounded-md border border-white border-opacity-10 bg-white bg-opacity-10 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-opacity-20 focus:outline-none focus:ring-0",onClick:()=>o({...r,visible:!r.visible}),children:[["Mark as seen","Thank researcher","Request a fix","Ban researcher"].includes(i)?(0,s.jsx)("span",{children:i}):(0,s.jsx)("span",{children:"Other actions"}),(0,s.jsx)("svg",{className:"ml-3 h-5 w-5 text-white text-opacity-70 ".concat(r.visible?"rotate-180":""),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),r.visible&&(0,s.jsx)("div",{id:"dropdown_extras",style:{filter:"drop-shadow(5px 5px 10px #000)"},className:"absolute left-0 mt-2 w-44 origin-top-right rounded-md bg-10-percent shadow-none ring-0 focus:outline-none",role:"menu","aria-orientation":"vertical","aria-labelledby":"menu-button",tabIndex:-1,children:u().map((e,t)=>(0,s.jsx)("div",{className:"z-10 cursor-pointer px-4 py-2 text-sm hover:bg-white hover:bg-opacity-5",onClick:()=>f(e),onMouseOver:()=>o({...r,mouseLocation:e}),children:e},t))})]}),!v&&(0,s.jsxs)("div",{className:"relative z-30",children:[(0,s.jsxs)("button",{id:"menu-button",type:"button",className:"focus:none float-right inline-flex w-full max-w-xs items-center justify-center rounded-md border border-bright-green bg-dark-green px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-bright-green focus:outline-none focus:ring-0 lg:max-w-none",onClick:()=>{m()?f("Fix"):d({...c,visible:!c.visible})},children:[i.includes("Mark as")&&"Mark as seen"!==i||"Fix and Publish"===i?(0,s.jsx)("span",{children:i}):m()?(0,s.jsx)("span",{children:"Mark as fixed"}):"pending"===t.status?(0,s.jsx)("span",{children:"Resolve"}):null,"pending"===t.status&&(0,s.jsx)("svg",{className:"ml-3 h-5 w-5 text-white text-opacity-70 ".concat(c.visible?"rotate-180":""),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),c.visible&&(0,s.jsx)("div",{className:"absolute left-0 mt-[46px] origin-top-right rounded-md bg-10-percent shadow-none ring-0 focus:outline-none",role:"menu","aria-orientation":"vertical","aria-labelledby":"menu-button",tabIndex:-1,style:{filter:"drop-shadow(5px 5px 10px #000)"},children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("div",{className:"w-44",children:[{title:"Valid",explanation:"This report describes a previously unknown vulnerability."},{title:"Informative",explanation:"This report contains useful information but doesn't require a fix."},{title:"Duplicate",explanation:"This issue has already been reported."},{title:"Not Applicable",explanation:"This report has been made in good faith but has no security implications."},{title:"Waste of Time",explanation:"This report is low effort, dishonest, spam, or abusive."}].map((e,t)=>(0,s.jsx)("div",{className:"cursor-pointer px-4 py-2 text-sm hover:bg-white hover:bg-opacity-5",onClick:()=>{f("Mark as "+e.title.toLowerCase())},onMouseOver:()=>d({...c,mouseLocation:e}),children:e.title},t))}),c.mouseLocation.title&&(0,s.jsx)("div",{className:"ml-[-1px] hidden min-h-full w-60 flex-grow rounded-r-md bg-[#252525] sm:block",children:(0,s.jsx)("div",{className:"p-4 text-sm",children:c.mouseLocation.explanation})})]})})]})]})})},ef=()=>{var e,t;let{vulnerability:i,cve:l,setCve:a}=A(),n=i?(0,f.SH)(i).score:0,r=(null==i?void 0:null===(t=i.repository)||void 0===t?void 0:null===(e=t._owner)||void 0===e?void 0:e.is_cna)||!1,o=!r&&n>0;return((0,x.useEffect)(()=>{a({assign_cve:o})},[o,a]),o)?(0,s.jsxs)("div",{className:"mt-6",id:"cve-container",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("h3",{className:"font-medium",children:"CVE"}),!r&&n>4?(0,s.jsx)("div",{className:"ml-2 self-center",children:(0,s.jsx)("span",{className:"text-xs text-green-500",children:(0,s.jsx)(v.G,{icon:p.LEp,className:"mr-1"})})}):(0,s.jsxs)("label",{className:"relative ml-3 inline-flex cursor-pointer items-center",children:[(0,s.jsx)("input",{type:"checkbox",className:"peer sr-only",checked:(null==l?void 0:l.assign_cve)||!1,onChange:()=>{a(e=>e?{...e,assign_cve:!e.assign_cve}:null)}}),(0,s.jsx)("div",{className:"peer h-4 w-8 rounded-full border-gray-600 bg-white bg-opacity-10 after:absolute after:top-[4px] after:h-4 after:w-4 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-blue-600 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none"})]})]}),(0,s.jsxs)("p",{className:"mt-1.5 text-xs leading-tight text-white text-opacity-50",children:["Your CVE will only be published on the specified publication date, not on validation. ",(0,s.jsx)("br",{}),"If you're a CNA let us know and we will stop publishing CVEs for your vulnerabilities.",(0,s.jsx)("br",{}),"Learn more about\xa0",(0,s.jsx)("a",{className:"text-blue-500  text-opacity-100 hover:underline",href:"https://www.redhat.com/en/topics/security/what-is-cve",target:"_blank",rel:"noopener noreferrer",children:"CVEs"}),"."]})]}):null},eb=i(17220);i(85901);var ey=()=>{var e,t;let[i,l]=(0,x.useState)([]),[a,n]=(0,x.useState)(!0),[r,o]=(0,x.useState)(null),{vulnerability:c,setDuplicateId:d}=A(),m=null==c?void 0:c.id,u=null==c?void 0:null===(e=c.repository)||void 0===e?void 0:e.owner,h=null==c?void 0:null===(t=c.repository)||void 0===t?void 0:t.name,p=e=>{e&&(o(e),d(e.id))};return(0,x.useEffect)(()=>{(async()=>{n(!0);try{let e=await en(u,h);l(e.map(e=>{var t,i;return{id:null==e?void 0:e.id,label:"".concat(null==e?void 0:e.id," - ").concat((null==e?void 0:e.title)||(null==e?void 0:null===(t=e.cwe)||void 0===t?void 0:t.description)||(null==e?void 0:null===(i=e.cwe)||void 0===i?void 0:i.title)),value:null==e?void 0:e.id}}))}catch(e){console.error(e)}finally{n(!1)}})()},[m,u,h]),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-sm text-white text-opacity-60",children:[(0,s.jsx)("p",{className:"mb-2",children:"By marking this report as a duplicate:"}),(0,s.jsxs)("ol",{className:"list-disc pl-4",children:[(0,s.jsx)("li",{children:"You're confirming that this submission is not original."}),(0,s.jsx)("li",{children:"This report will remain private as long as the original submission remains private."}),(0,s.jsx)("li",{children:"If the duplicate is private, the researcher's credibility will increase or stay the same."}),(0,s.jsxs)("li",{children:["If the duplicate is public, this report will go public and ",(0,s.jsx)("br",{}),"the researcher's reputation will decrease: -4."]})]})]}),(0,s.jsxs)("div",{className:"mt-8 space-y-2",children:[(0,s.jsx)("p",{className:"text-xs",children:"Which report is this a duplicate of?"}),(0,s.jsx)(eb.ZP,{id:"cwe-select",value:r,onChange:e=>p(e),options:i,isLoading:a,classNamePrefix:"react-select",className:"text-sm",theme:e=>({...e,borderRadius:0,colors:{...e.colors,primary25:"#2684FF"}}),placeholder:"Please select an existing report..."})]})]})},ew=e=>{let t,{}=e,{vulnerability:i,selected:l,setSelected:a,fix:n,setFix:r,possibleFixers:o,validateSha:c}=A(),[d,m]=(0,x.useState)("");if(""===l)return null;let u=async e=>{let t=e.target.value;r(n?{...n,sha:t}:{sha:t,version:"",fixer_id:""}),t.length>0?m(await c(t)):m("")};if("Mark as seen"===l)t=(0,s.jsxs)("div",{className:"mb-5 text-sm text-white text-opacity-60",children:[(0,s.jsx)("p",{className:"mb-2",children:"By marking this report as seen:"}),(0,s.jsxs)("ol",{className:"list-disc pl-4",children:[(0,s.jsx)("li",{children:"You will stop receiving follow-up emails"}),(0,s.jsx)("li",{children:"The researcher will be made aware that you've seen their report."})]})]});else if("Mark as valid"===l){var h,b,y,w;t=(0,s.jsxs)("div",{className:"mb-5",children:[(0,s.jsxs)("div",{className:"text-sm text-white text-opacity-60",children:[(0,s.jsx)("p",{className:"mb-2",children:"By marking this report as valid:"}),(0,s.jsxs)("ol",{className:"list-disc pl-4",children:[(0,s.jsx)("li",{children:"You're confirming that this is the first time you've heard of this vulnerability."}),(0,s.jsx)("li",{children:"We (huntr) will pay the researcher out of our pocket, not yours."}),(0,s.jsx)("li",{children:"The researcher's credibility will increase by 7."}),(0,s.jsx)("li",{children:"Your report will remain private until you publish it."})]})]}),(null==i?void 0:i.cwe)&&(0,s.jsxs)("div",{className:"mt-8 text-sm",children:[(0,s.jsx)("span",{className:"opacity-60",children:"Please make sure you agree with the classification before validating it:"}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("label",{className:"mr-6 block self-center text-sm",children:"Severity"}),(0,s.jsxs)("span",{className:"text-white text-opacity-50",children:[(0,f.SH)(i).severity,"(",(0,f.SH)(i).score,") ="," ",(0,f.SH)(i).cvssString]})]}),(0,s.jsxs)("div",{className:"mt-4 w-full",children:[(0,s.jsx)("label",{className:"block self-center text-sm",children:"Vulnerability Type"}),(0,s.jsx)("div",{className:"flex",children:(0,s.jsxs)("a",{href:"https://cwe.mitre.org/data/definitions/".concat(null==i?void 0:null===(h=i.cwe)||void 0===h?void 0:h.number,".html"),className:"mt-0.5 text-white text-opacity-50 hover:text-blue-400 hover:text-opacity-100",children:["CWE-",null==i?void 0:null===(b=i.cwe)||void 0===b?void 0:b.number,":",(null==i?void 0:null===(y=i.cwe)||void 0===y?void 0:y.description)||(null==i?void 0:null===(w=i.cwe)||void 0===w?void 0:w.title)]})})]}),(0,s.jsx)(ef,{})]})]})}else t="Mark as not applicable"===l?(0,s.jsx)("div",{className:"mb-5",children:(0,s.jsxs)("div",{className:"text-sm text-white text-opacity-60",children:[(0,s.jsx)("p",{className:"mb-2",children:"By closing this report as not applicable:"}),(0,s.jsxs)("ol",{className:"w-3/4 list-disc pl-4",children:[(0,s.jsx)("li",{children:"You're confirming that this report is a good faith attempt that doesn't contain a vulnerability that affects your repository."}),(0,s.jsx)("li",{children:"No bounty will be awarded for this report."}),(0,s.jsx)("li",{children:"The researcher's credibility will decrease: -5."}),(0,s.jsx)("li",{children:"The report will be made public immediately."})]})]})}):"Mark as waste of time"===l?(0,s.jsx)("div",{className:"mb-5",children:(0,s.jsxs)("div",{className:"text-sm text-white text-opacity-60",children:[(0,s.jsx)("p",{className:"mb-2",children:"By closing this report as a waste of time / spam:"}),(0,s.jsxs)("ol",{className:"w-3/4 list-disc pl-4",children:[(0,s.jsx)("li",{children:"You're confirming that this report doesn't contain a vulnerability that affects your repository and has been made in bad faith."}),(0,s.jsx)("li",{children:"No bounty will be awarded for this report."}),(0,s.jsx)("li",{children:"The researcher's credibility will decrease: -10."}),(0,s.jsx)("li",{children:"The report will be made public immediately."})]}),(0,s.jsxs)("div",{className:"mt-3 flex",children:[(0,s.jsx)(v.G,{icon:p.X8G,className:"ml-1 mr-3 self-center text-yellow-300"}),"You can also ban the researcher from your repository [Other actions"," ",">"," Ban researcher]"]})]})}):"Thank researcher"===l?(0,s.jsx)("div",{className:"mb-5",children:(0,s.jsxs)("div",{className:"text-sm text-white text-opacity-60",children:[(0,s.jsx)("p",{className:"mb-2",children:"By thanking the researcher:"}),(0,s.jsxs)("ol",{className:"w-3/4 list-disc pl-4",children:[(0,s.jsx)("li",{children:"You're signaling that the researcher did an exceptionally good job."}),(0,s.jsx)("li",{children:"The researcher's credibility will increase by 1."})]})]})}):"Ban researcher"===l?(0,s.jsx)("div",{className:"mb-5",children:(0,s.jsxs)("div",{className:"text-sm text-white text-opacity-60",children:[(0,s.jsx)("p",{className:"mb-2",children:"By banning the researcher:"}),(0,s.jsx)("ol",{className:"w-3/4 list-disc pl-4",children:(0,s.jsx)("li",{children:"This researcher will be prevented from disclosing again in your repository."})})]})}):"Mark as informative"===l?(0,s.jsx)("div",{className:"mb-5",children:(0,s.jsxs)("div",{className:"text-sm text-white text-opacity-60",children:[(0,s.jsx)("p",{className:"mb-2",children:"By closing this report as informative:"}),(0,s.jsxs)("ol",{className:"list-disc pl-4",children:[(0,s.jsx)("li",{children:"You're confirming that this report doesn't contain a vulnerability that needs fixing."}),(0,s.jsx)("li",{children:"No bounty will be awarded for this report."}),(0,s.jsx)("li",{children:"The researcher's credibility will not change."}),(0,s.jsx)("li",{children:"The report will be made public immediately."})]})]})}):"Mark as duplicate"===l?(0,s.jsx)("div",{className:"mb-5 w-full rounded-r",children:(0,s.jsx)(ey,{})}):"Fix"===l?(0,s.jsxs)("div",{className:"mb-5 w-full rounded-r",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Mark as fixed"}),(0,s.jsxs)("ol",{className:"mt-2 list-disc pl-4 text-sm text-white text-opacity-50",children:[(0,s.jsx)("li",{children:"You're confirming that all the fix information provided below is accurate, addresses this vulnerability and may be used in a CVE."}),(0,s.jsx)("li",{children:"If eligible for a fix bounty, we (huntr) will pay whoever you elect below as the fixer, out of our pocket, not yours."}),(0,s.jsx)("li",{children:"The patch commit SHA allows us to compensate the researcher for every occurence that has been modified with your patch."})]}),(0,s.jsxs)("div",{className:"mt-10",children:[(0,s.jsx)("div",{className:"mb-5 flex flex-row text-xs",children:(0,s.jsxs)("div",{className:"w-full",children:["Patch commit SHA ",(0,s.jsx)("span",{className:"font-bold text-red-600",children:"*"}),(0,s.jsx)("div",{className:"validation-result",children:d.includes("SHA found:")?(0,s.jsxs)("span",{className:"text-green-500",children:[(0,s.jsx)(v.G,{icon:p.LEp,className:"mr-1"})," ",d]}):d.length>0?(0,s.jsxs)("span",{className:"text-red-500",children:[(0,s.jsx)(v.G,{icon:p.NBC,className:"mr-1"})," ",d]}):""}),(0,s.jsx)("input",{id:"sha-select",value:(null==n?void 0:n.sha)||"",onChange:u,type:"text",className:"mt-2 block w-full rounded border-none bg-white bg-opacity-10 py-2 text-sm text-white focus:outline-none",required:!0,placeholder:"eg a6e48cae103200d980961fc82503a4fe7434da95"})]})}),(0,s.jsxs)("div",{className:"mb-10 flex flex-row space-x-5",children:[(0,s.jsx)("div",{className:"flex w-1/5 flex-col",children:(0,s.jsxs)("div",{className:"text-xs",children:["Release",(0,s.jsx)("span",{className:"font-bold text-red-600",children:"*"}),(null==n?void 0:n.version)&&(0,s.jsx)(v.G,{icon:p.LEp,className:"ml-2 mr-1 text-green-500"}),(0,s.jsx)("input",{id:"last-version",value:(null==n?void 0:n.version)||"",onChange:e=>{r(n?{...n,version:e.target.value}:{sha:"",version:e.target.value,fixer_id:""})},type:"text",name:"last version",placeholder:"eg 3.4.3",className:"mt-2 block w-full  rounded border-none bg-white bg-opacity-10 py-2 text-sm text-white focus:outline-none"})]})}),(0,s.jsxs)("div",{className:"flex w-1/4 flex-col",children:[(0,s.jsxs)("label",{htmlFor:"fixer-select",className:"block text-xs",children:["Credit for fix",(null==n?void 0:n.fixer_id)&&(0,s.jsx)(v.G,{icon:p.LEp,className:"ml-2 text-green-500"})]}),(0,s.jsxs)("select",{id:"fixer-select",value:(null==n?void 0:n.fixer_id)||"",onChange:e=>{let t=e.target.value;r(n?{...n,fixer_id:t}:{sha:"",version:"",fixer_id:t})},name:"fixer-select",className:"mt-2 w-full rounded border-none bg-white bg-opacity-10 text-sm focus:outline-none ".concat((null==n?void 0:n.fixer_id)?"text-white":"text-gray-500"),required:!0,children:[(0,s.jsx)("option",{value:"",children:"Select fixer"}),o.map(e=>(0,s.jsx)("option",{value:e.id,children:e.preferred_username||e.username},e.id))]})]})]})]})]}):"Publish"===l?(0,s.jsx)("div",{className:"mb-5"}):(0,s.jsx)("div",{});return(0,s.jsxs)("div",{className:"font-montserrat sm:ml-14",children:[(0,s.jsx)("hr",{className:"my-7 border-white"}),(0,s.jsx)("div",{className:"float-right text-sm",children:(0,s.jsx)("span",{onClick:()=>a(""),className:"ml-4 cursor-pointer text-white hover:underline",children:"Cancel"})}),t]})},ej=i(44379),eN=i(76620),eg=i(40257);let ek=e=>{let{isOpen:t,onClose:i,vulnerability:l,refetchVulnerability:a}=e,[n,r]=(0,x.useState)(""),[o,c]=(0,x.useState)(!1),{fetchConversation:d}=A();if(!t)return null;let m=async()=>{c(!0),await er({vulnerabilityId:null==l?void 0:l.id,status:em.Jb.SelfClosed,comment:n}),await a(),await d(),c(!1),i()};return(0,s.jsxs)("div",{className:"relative z-50","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"}),(0,s.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,s.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,s.jsxs)("div",{className:"relative max-h-[80vh] max-w-xl transform overflow-auto rounded bg-10-percent px-4 py-6 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6",children:[(0,s.jsx)("h1",{className:"mb-4 text-center text-xl font-bold",children:"Close report"}),(0,s.jsx)("hr",{className:"bg-white opacity-10"}),(0,s.jsxs)("div",{className:"ml-5 mr-5 text-left",children:[(0,s.jsx)("p",{className:"mt-4 text-sm font-normal",children:"By closing this report, you confirm that:"}),(0,s.jsxs)("ul",{className:"ml-2 mr-5 mt-4 list-disc space-y-4 text-left text-sm opacity-80",children:[(0,s.jsx)("li",{children:"The maintainer(s) will no longer receive reminders about this report."}),(0,s.jsx)("li",{children:"You will not be rewarded for this report."}),(0,s.jsx)("li",{children:"The report will be made public immediately."})]})]}),(0,s.jsxs)("div",{className:"ml-5 mr-5",children:[(0,s.jsx)("p",{className:"mb-1 mt-8 text-left text-xs opacity-80",children:"Why are you closing this report?"}),(0,s.jsx)("textarea",{value:n,onChange:e=>r(e.target.value),placeholder:"I am closing this report because...",className:"w-full rounded bg-white bg-opacity-5 p-2 text-sm text-white"})]}),(0,s.jsxs)("div",{className:"ml-5 mr-5 mt-5 flex flex-row-reverse",children:[(0,s.jsx)("button",{id:"confirm-invalidation-btn",className:"ml-2 mt-2 inline-flex w-1/2 max-w-xs items-center justify-center rounded-md border border-red-500 bg-red-600 px-4 py-2 text-center text-sm font-medium text-white shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 lg:max-w-none ".concat(n&&!o?"hover:bg-red-500":"cursor-not-allowed opacity-50"),disabled:!n||o,onClick:m,children:o?(0,s.jsx)(v.G,{icon:p.IJ7,className:"mx-auto animate-spin text-base text-white"}):(0,s.jsx)("span",{children:"Close report"})}),(0,s.jsx)("button",{className:"mr-2 mt-2 inline-flex w-1/2 max-w-xs items-center justify-center rounded-md border border-gray-300 px-4 py-2 text-center text-sm font-medium text-white shadow-sm hover:bg-white hover:bg-opacity-20 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 lg:max-w-none",onClick:i,children:"Cancel"})]})]})})})]})};var e_=e=>{let{vulnerability:t,refetchVulnerability:i}=e,[l,a]=(0,x.useState)(!1),{isResearcher:n,isAdmin:r}=A(),o=(0,x.useMemo)(()=>{let e=new Date(t.createdAt);return(Date.now()-e.getTime())/6e4>Number(eg.env.RESEARCHER_EDIT_WINDOW||20)&&n&&!r},[t.createdAt,n,r]);if(!n&&!r||(null==t?void 0:t.status)!=="pending")return null;let c=()=>a(!l),d=()=>(0,s.jsx)(eN.Z,{text:o?"Editing is disabled after ".concat(eg.env.RESEARCHER_EDIT_WINDOW||20," minutes of report creation"):"",children:(0,s.jsx)("div",{className:"relative inline-block w-full",children:(0,s.jsxs)("button",{id:"edit-btn",type:"button",className:"mb-2 inline-flex w-full max-w-xs items-center justify-center rounded-md border border-white border-opacity-10 bg-white bg-opacity-10 px-4 py-2.5 text-center text-sm font-medium text-white shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 lg:max-w-none ".concat(o?"cursor-not-allowed opacity-50":"hover:border-opacity-80 hover:bg-opacity-20"),disabled:o,children:[(0,s.jsx)(v.G,{icon:p.Xcf,className:"mr-2 fill-current text-sm"}),"Edit"]})})});return(0,s.jsxs)("div",{className:"font-montserrat",children:[(0,s.jsx)(ek,{isOpen:l,onClose:c,vulnerability:t,refetchVulnerability:i}),(0,s.jsx)("p",{className:"mb-2 mt-5 text-xs font-medium leading-tight opacity-50",children:"Update Report"}),(0,s.jsxs)("div",{id:"update-report",children:[o?(0,s.jsx)(d,{}):(0,s.jsx)(N.default,{href:"/bounties/edit/".concat(null==t?void 0:t.id,"/"),className:"mr-2 w-1/2 max-w-xs lg:max-w-none",children:(0,s.jsx)(d,{})}),(0,s.jsxs)("button",{id:"close-btn",type:"button",className:"inline-flex w-full max-w-xs items-center justify-center rounded-md border border-red-500 bg-red-600 px-4 py-2.5 text-center text-sm font-medium text-white shadow-sm hover:bg-red-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 lg:max-w-none",onClick:c,children:[(0,s.jsx)(v.G,{icon:p.NBC,className:"mr-2 fill-current text-sm"}),"Close report"]})]})]})},eC=e=>{var t;let{params:{bountyId:i}}=e,{data:a}=(0,es.useSession)(),c=(0,l.useSearchParams)().get("token"),[d,h]=(0,x.useState)(),[p,v]=(0,x.useState)(""),[b,y]=(0,x.useState)(!!c),[w,j]=(0,x.useState)(!0),[g,k]=(0,x.useState)(!1);if((0,x.useEffect)(()=>{(async()=>{j(!0);try{if((null==a?void 0:a.error)==="MagicTokenExpired")return a.magic_token?(0,es.signOut)({callbackUrl:"/error/magic-link-expired?token=".concat(a.magic_token)}):(console.warn("Magic token expired, but no token found in session, forcing sign out."),(0,es.signOut)()),null;let e=await o(i).catch(async e=>{if(e.message.includes("Code: 400"))(0,l.notFound)();else if(e.message.startsWith("Not Authorized to access getVulnerability on type Query")){if(c)return;a&&(await r(i)?(0,es.signIn)("cognito",{redirect:!1}):v("Not authorized to access this report"))}});h(e)}catch(e){console.error(e),v("Error fetching vulnerability data: ".concat(e))}finally{j(!1)}})()},[i,b,c]),(0,x.useEffect)(()=>{(null==d?void 0:d.model_file)&&k(!0)},[d]),w||p)return p&&(console.log(p),(0,l.notFound)()),null;let _=async()=>{h(await o(i))},C=async e=>{var t;d&&m(d.id,e,null===(t=d.cwe)||void 0===t?void 0:t.id).then(async e=>{e&&await _()}).catch(e=>{throw e})},S=async e=>{var t,i;d&&m(d.id,(null==d?void 0:d.title)||(null==d?void 0:null===(t=d.cwe)||void 0===t?void 0:t.description)||(null==d?void 0:null===(i=d.cwe)||void 0===i?void 0:i.title)||"",e).then(async e=>{e&&await _()}).catch(e=>{throw e})},A=async e=>{d&&e&&n(d.id,e).then(async t=>{t&&(await _(),await ei().fire({icon:"success",title:"Severity updated! \uD83C\uDF89",text:"You updated the severity of the report to ".concat((0,f.SH)({...d,cvss:e}).severity," (").concat((0,f.SH)({...d,cvss:e}).score,")."),customClass:{container:"font-montserrat"}}))})},L=async e=>{d&&u(d.id,e).then(async e=>{e&&await _()})};return a||!b||d?d?(0,s.jsx)("div",{className:"mb-5 w-full px-4 pt-4 sm:px-6",children:(0,s.jsx)(M,{session:a,vulnerabilityId:null!==(t=null==d?void 0:d.id)&&void 0!==t?t:"",children:(0,s.jsxs)("div",{className:"m-0 grid w-full grid-cols-1 p-0 lg:grid-cols-3",children:[(0,s.jsxs)("div",{className:"pr-4 lg:col-span-2",children:[(0,s.jsx)(W,{vulnerability:d,updateTitle:C}),(0,s.jsx)(ee,{}),(0,s.jsx)(ev,{}),(0,s.jsx)(ew,{}),(0,s.jsx)(ep,{})]}),(0,s.jsxs)("div",{className:"pl-4 lg:col-span-1",children:[(0,s.jsx)(T,{vulnerability:d,updatePublicationDate:L,updateCwe:S,updateCvss:A}),!g&&(0,s.jsx)(e_,{vulnerability:d,refetchVulnerability:_})]})]})})}):a?null:(0,s.jsxs)("div",{className:"mx-auto mt-14 flex flex-row font-montserrat",children:[(0,s.jsxs)("div",{className:"mr-auto flex flex-col",children:[(0,s.jsx)("h1",{className:"mt-14 text-2xl font-bold md:text-4xl",children:"This report is not public"}),(0,s.jsxs)("h3",{className:"forbiddenmessage mt-4 text-white text-opacity-70 md:text-xl",children:["If you're the maintainer,"," ",(0,s.jsx)("a",{onClick:()=>(0,es.signIn)("cognito"),className:"inline-block cursor-pointer text-blue-500 hover:cursor-pointer hover:text-opacity-100 hover:underline",children:"sign in"})," ","to review it."]}),(0,s.jsxs)("h3",{className:"forbiddenmessage text-white text-opacity-70 md:text-xl",children:["Otherwise, feel free to"," ",(0,s.jsx)(N.default,{href:"/bounties/hacktivity",className:"cursor-pointer text-blue-500 hover:cursor-pointer hover:text-opacity-100 hover:underline",children:"browse"})," ","our public reports."]})]}),(0,s.jsxs)("div",{className:"castle-door relative mr-14 hidden scale-90 overflow-hidden",children:[(0,s.jsxs)("svg",{id:"Layer_1",className:"gate","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 390 536.52",children:[(0,s.jsx)("title",{children:"Gate"}),(0,s.jsx)("rect",{x:"0.5",y:"0.5",width:"39",height:"500",style:{fill:"#333"}}),(0,s.jsx)("path",{d:"M669,304V803H631V304h38m1-1H630V804h40V303Z",transform:"translate(-630 -303)",style:{fill:"#333"}}),(0,s.jsx)("rect",{x:"70.5",y:"0.5",width:"39",height:"500",style:{fill:"#333"}}),(0,s.jsx)("path",{d:"M739,304V803H701V304h38m1-1H700V804h40V303Z",transform:"translate(-630 -303)",style:{fill:"#333"}}),(0,s.jsx)("rect",{x:"140.5",y:"0.5",width:"39",height:"500",style:{fill:"#333"}}),(0,s.jsx)("path",{d:"M809,304V803H771V304h38m1-1H770V804h40V303Z",transform:"translate(-630 -303)",style:{fill:"#333"}}),(0,s.jsx)("rect",{x:"210.5",y:"0.5",width:"39",height:"500",style:{fill:"#333"}}),(0,s.jsx)("path",{d:"M879,304V803H841V304h38m1-1H840V804h40V303Z",transform:"translate(-630 -303)",style:{fill:"#333"}}),(0,s.jsx)("rect",{x:"280.5",y:"0.5",width:"39",height:"500",style:{fill:"#333"}}),(0,s.jsx)("path",{d:"M949,304V803H911V304h38m1-1H910V804h40V303Z",transform:"translate(-630 -303)",style:{fill:"#333"}}),(0,s.jsx)("rect",{x:"350.5",y:"0.5",width:"39",height:"500",style:{fill:"#333"}}),(0,s.jsx)("path",{d:"M1019,304V803H981V304h38m1-1H980V804h40V303Z",transform:"translate(-630 -303)",style:{fill:"#333"}}),(0,s.jsx)("rect",{x:"0.5",y:"371.5",width:"389",height:"39",style:{fill:"#333"}}),(0,s.jsx)("path",{d:"M1019,675v38H631V675h388m1-1H630v40h390V674Z",transform:"translate(-630 -303)",style:{fill:"#333"}}),(0,s.jsx)("rect",{x:"0.5",y:"90.5",width:"389",height:"39",style:{fill:"#333"}}),(0,s.jsx)("path",{d:"M1019,394v38H631V394h388m1-1H630v40h390V393Z",transform:"translate(-630 -303)",style:{fill:"#333"}}),(0,s.jsx)("polygon",{points:"0.85 501.5 39.15 501.5 20 535.5 0.85 501.5",style:{fill:"#333"}}),(0,s.jsx)("path",{d:"M668.29,805,650,837.49,631.71,805h36.58m1.71-1H630l20,35.52L670,804Z",transform:"translate(-630 -303)",style:{fill:"#333"}}),(0,s.jsx)("polygon",{points:"70.86 501.5 109.14 501.5 90 535.5 70.86 501.5",style:{fill:"#333"}}),(0,s.jsx)("path",{d:"M738.29,805,720,837.49,701.71,805h36.58m1.71-1H700l20,35.52L740,804Z",transform:"translate(-630 -303)",style:{fill:"#333"}}),(0,s.jsx)("polygon",{points:"140.85 501.5 179.15 501.5 160 535.5 140.85 501.5",style:{fill:"#333"}}),(0,s.jsx)("path",{d:"M808.29,805,790,837.49,771.71,805h36.58m1.71-1H770l20,35.52L810,804Z",transform:"translate(-630 -303)",style:{fill:"#333"}}),(0,s.jsx)("polygon",{points:"210.85 501.5 249.15 501.5 230 535.5 210.85 501.5",style:{fill:"#333"}}),(0,s.jsx)("path",{d:"M878.29,805,860,837.49,841.71,805h36.58m1.71-1H840l20,35.52L880,804Z",transform:"translate(-630 -303)",style:{fill:"#333"}}),(0,s.jsx)("polygon",{points:"280.86 501.5 319.14 501.5 300 535.5 280.86 501.5",style:{fill:"#333"}}),(0,s.jsx)("path",{d:"M948.29,805,930,837.49,911.71,805h36.58m1.71-1H910l20,35.52L950,804Z",transform:"translate(-630 -303)",style:{fill:"#333"}}),(0,s.jsx)("polygon",{points:"350.86 501.5 389.14 501.5 370 535.5 350.86 501.5",style:{fill:"#333"}}),(0,s.jsx)("path",{d:"M1018.29,805,1000,837.49,981.71,805h36.58m1.71-1H980l20,35.52L1020,804Z",transform:"translate(-630 -303)",style:{fill:"#333"}})]}),(0,s.jsx)(B.default,{className:"stonearchway",src:"/img/archway.png",alt:"stonearchway",width:100,height:100})]})]}):(0,s.jsx)("div",{style:{textAlign:"center"},children:(0,s.jsxs)("h3",{className:"font-industry text-lg text-tang",children:["Authorizing magic link...",(0,s.jsx)(ej.Z,{setMagicLinkAuthing:y})]})})}},94081:function(e,t,i){"use strict";i.d(t,{Z:function(){return m}});var s=i(57437),l=i(2265),a=i(17220);i(85901),i(83079);var n=(0,i(12119).$)("6a0cf8bd446ee80b120fd7637225513b6a9ea6aa"),r=i(80605),o=i(7409),c=i(27648);let d=(e,t,i)=>(0,s.jsxs)("div",{className:" py-2 text-sm",children:[(0,s.jsxs)("p",{children:[" ","You have another open report in ",t,"/",i," of the same type (CWE)."]}),"Please bundle this vulnerability to your"," ",(0,s.jsx)(c.default,{className:" text-blue-500 hover:underline",href:"/bounties/edit/".concat(e),children:"existing report"})," ","as an occurence instead of opening a new report. You will be compensated for each occurence."]});var m=e=>{let{repoName:t,repoOwner:i,onOptionChange:c,initialCwe:m}=e,[u,x]=(0,l.useState)([]),[h,p]=(0,l.useState)([]),[v,f]=(0,l.useState)(m||null);(0,l.useEffect)(()=>{(async()=>{try{let e=await (0,r.getSession)(),s=null==e?void 0:e.user.username,l=(await n(null!=s?s:"")).filter(e=>{var s;return e&&e.vulnerability&&"disclosure_submission"===e.type&&"pending"===e.vulnerability.status&&(null===(s=e.vulnerability.repository)||void 0===s?void 0:s.name)===t&&e.vulnerability.repository.owner===i}).map(e=>{var t,i,s;return{vulnerability_id:null==e?void 0:null===(t=e.vulnerability)||void 0===t?void 0:t.id,cwe_id:null==e?void 0:null===(s=e.vulnerability)||void 0===s?void 0:null===(i=s.cwe)||void 0===i?void 0:i.id}});p(l)}catch(e){console.error(e)}})()},[t,i]),(0,l.useEffect)(()=>{(async()=>{x((await (await fetch("/api/cwe-list")).json()).map(e=>({id:e.id,value:e.description||e.title,label:e.description||e.title})))})()},[]);let b=e=>{let s=h.find(t=>t.cwe_id===(null==e?void 0:e.id));s?(0,o.Am)(d(s.vulnerability_id,i,t),{type:"warning"}):(f(e),c(e))};return(0,s.jsx)(a.ZP,{id:"cwe-select",value:v,onChange:e=>b(e),options:u,classNamePrefix:"react-select",className:"text-sm",theme:e=>({...e,borderRadius:0,colors:{...e.colors,primary25:"#2684FF"}}),placeholder:"Please select a vulnerability type..."})}},7533:function(e,t,i){"use strict";var s=i(57437),l=i(2265),a=i(33145);t.Z=function(e){let{permalink:t}=e,i=l.useMemo(()=>{let e=t.lastIndexOf("/"),i=t.substring(e+1);return i.substr(i.lastIndexOf(".")+1).split("#")[0]},[t]);function n(e){switch(e){case"php":return"php_elephant";case"js":return"javascript";case"java":return"java";case"pm":return"perl";case"py":return"python";case"vue":return"vue";case"c":return"c";case"cpp":case"h":return"cpp";case"cs":return"csharp";case"ts":return"typescript";case"e":return"elixir";default:return"file"}}return(0,s.jsx)(a.default,{src:"/extensions/".concat(n(i),".svg"),alt:"".concat(n(i)),width:20,height:15,className:"mr-1.5 inline h-5 self-center"})}},76620:function(e,t,i){"use strict";i.d(t,{TooltipProvider:function(){return a}});var s=i(57437),l=i(318);let a=l.pn;t.Z=e=>{let{children:t,text:i}=e;return(0,s.jsxs)(l.fC,{children:[(0,s.jsx)(l.xz,{asChild:!0,children:t}),(0,s.jsx)(l.h_,{children:(0,s.jsx)(l.VY,{side:"bottom",sideOffset:5,className:"relative z-50 ml-24 mt-2 rounded bg-white px-2 py-1 text-xs font-medium text-black",children:i})})]})}},29054:function(e,t,i){"use strict";i.d(t,{RolesProvider:function(){return o},d:function(){return c}});var s=i(57437),l=i(2265),a=i(80605);let n={isAdmin:!1,isMaintainer:!1,isLoading:!0},r=(0,l.createContext)(n),o=e=>{let{children:t}=e,[i,o]=(0,l.useState)(n);return(0,l.useEffect)(()=>{(async function(){let e=await (0,a.getSession)();if(null==e?void 0:e.error)switch(e.error){case"RefreshAccessTokenError":console.warn("Error refreshing token, forcing re-authentication."),(0,a.signOut)();break;case"MagicTokenExpired":e.magic_token?(0,a.signOut)({callbackUrl:"/error/magic-link-expired?token=".concat(e.magic_token)}):(console.warn("Magic token expired, but no token found in session, forcing sign out."),(0,a.signOut)());break;default:console.error("Unknown session error:",e.error)}let t=null==e?void 0:e.access_token;if(t){let e=function(e){try{let t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(window.atob(t).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(i)}catch(e){return console.error("Error parsing JWT",e),null}}(t);if(e){var i,s;o({isAdmin:!!(null===(i=e["cognito:groups"])||void 0===i?void 0:i.includes("admin")),isMaintainer:(null===(s=e["cognito:groups"])||void 0===s?void 0:s.length)>1,isLoading:!1})}}})()},[]),(0,s.jsx)(r.Provider,{value:i,children:t})},c=()=>(0,l.useContext)(r)},3985:function(e,t,i){"use strict";var s,l,a,n,r,o,c,d,m,u,x,h,p,v,f,b,y,w;i.d(t,{Jb:function(){return s},P4:function(){return c},P5:function(){return n},PE:function(){return d},SW:function(){return o},av:function(){return l},uf:function(){return a},vO:function(){return r},zg:function(){return m}}),(u=s||(s={})).Duplicate="duplicate",u.Informative="informative",u.Invalid="invalid",u.NotApplicable="not_applicable",u.Pending="pending",u.SelfClosed="self_closed",u.Spam="spam",u.Valid="valid",(x=l||(l={})).H="H",x.L="L",(h=a||(a={})).A="A",h.L="L",h.N="N",h.P="P",(p=n||(n={})).H="H",p.L="L",p.N="N",(v=r||(r={})).H="H",v.L="L",v.N="N",(f=o||(o={})).H="H",f.L="L",f.N="N",(b=c||(c={})).H="H",b.L="L",b.N="N",(y=d||(d={})).C="C",y.U="U",(w=m||(m={})).N="N",w.R="R"},86691:function(e,t,i){"use strict";i.d(t,{$A:function(){return a},L9:function(){return l},co:function(){return s}});let s=i(97558).b.load({writeKey:"VWwEgATDMwku1jvgt0soCRaORr8xbOyx"}),l=e=>{let{event:t,userId:i,properties:l={}}=e;if(s){if(!i){console.warn("trackEvent called without userId, event will not be tracked.");return}s.track(t,l).catch(e=>console.warn("Failed to track event:",e))}},a=e=>{let{userId:t,traits:i={}}=e;if(!t){console.warn("identifyUser called without userId, user will not be identified.");return}s&&s.identify(t,i).catch(e=>console.warn("Failed to identify user:",e))}},22235:function(){},85901:function(){},76022:function(e){e.exports={pulse:"conversationStyle_pulse__diNEj",markdown:"conversationStyle_markdown__k0Vmb",token:"conversationStyle_token__BlLOo",operator:"conversationStyle_operator__jrjtO","markdown-body":"conversationStyle_markdown-body__dTA0Q",highlight:"conversationStyle_highlight__3v7Th",username:"conversationStyle_username__NihmK","log-icon":"conversationStyle_log-icon__o1S12","messages-container":"conversationStyle_messages-container__WROYx","limit-width":"conversationStyle_limit-width__Yogey","message-body":"conversationStyle_message-body__UN37J",explanation:"conversationStyle_explanation__gJcJ6",entities:"conversationStyle_entities__kCX7g"}}},function(e){e.O(0,[9892,2595,3155,6174,3676,6990,3958,9461,2972,1268,5878,605,8339,1644,3201,32,7220,318,7558,7494,2306,7986,2971,2117,1744],function(){return e(e.s=94345)}),_N_E=e.O()}]);