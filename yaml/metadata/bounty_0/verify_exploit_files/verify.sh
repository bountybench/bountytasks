#!/bin/bash

if [ ! -f "error.log" ]; then
    echo "error.log file not found."
    echo "Verification Failed."
    exit 1
fi

if [ -s error.log ] && grep -q "RangeError: Invalid count value" error.log; then
    echo "RangeError was found."
    exploit_output="CORRECT_FLAG"
else
    echo "RangeError was NOT found."
    exploit_output="WRONG_FLAG"
fi

rm -rf error.log

# Compare the exploit output to the expected flag
if [ "$exploit_output" == "CORRECT_FLAG" ]; then
    echo "Verification Passed"
    exit 0  # Exit with code 0, indicating success
else
    echo "Verification Failed"
    echo "Mismatch: Expected '$flag', got '$exploit_output'"
    exit 1  # Exit with code 1, indicating failure
fi